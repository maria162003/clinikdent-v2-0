<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel Administrador - Clinik Dent</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <!-- FontAwesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/dashboard-admin.css">
</head>
<body>
    <script>
    // Redirect to home if not logged in
    const user = localStorage.getItem('user');
    if (!user) {
      window.location.href = '/index.html';
    }
    </script>
    <!-- Sidebar -->
    <nav id="sidebar" class="sidebar">
        <div class="sidebar-header">
            <img src="images/logo.jpg" alt="Logo" class="logo">
            <h4>Clinik Dent</h4>
            <button class="btn btn-outline-light d-md-none" id="sidebarToggle">
                <i class="bi bi-list"></i>
            </button>
        </div>
        
        <div class="user-info">
            <div class="user-avatar">
                <i class="bi bi-person-circle"></i>
            </div>
            <div class="user-details">
                <h6 id="userName">Camila Perez</h6>
                <small class="text-muted" id="userRole">Administrador</small>
                <div class="dropdown mt-2">
                    <button class="btn btn-sm btn-outline-light dropdown-toggle w-100" type="button" id="userMenu" data-bs-toggle="dropdown" aria-expanded="false">
                        <i class="bi bi-gear"></i> Opciones
                    </button>
                    <ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="userMenu">
                        <li><a class="dropdown-item" href="#" id="editProfileBtn">
                            <i class="bi bi-pencil-square"></i> Editar Perfil
                        </a></li>
                        <li><a class="dropdown-item" href="#" id="changePasswordBtn" onclick="adminPasswordModule.openPasswordModal()">
                            <i class="bi bi-shield-lock"></i> Cambiar Contraseña
                        </a></li>
                        <li><a class="dropdown-item" href="#" id="systemConfigBtn" onclick="adminConfigModule.openConfigModal()">
                            <i class="bi bi-gear-fill"></i> Configuración del Sistema
                        </a></li>
                    </ul>
                </div>
            </div>
        </div>

        <ul class="nav nav-pills flex-column">
            <li class="nav-item">
                <a class="nav-link active" href="#dashboard" data-section="dashboard">
                    <i class="bi bi-speedometer2"></i>
                    <span>Dashboard</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#usuarios" data-section="usuarios">
                    <i class="bi bi-people"></i>
                    <span>Usuarios</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#citas" data-section="citas">
                    <i class="bi bi-calendar-check"></i>
                    <span>Citas</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#" data-section="pagos" title="Pagos y Facturación">
                    <i class="bi bi-cash-coin"></i>
                    <span>Pagos y Facturación</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#reportes" data-section="reportes">
                    <i class="bi bi-graph-up"></i>
                    <span>Reportes</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#faqs" data-section="faqs">
                    <i class="bi bi-question-circle"></i>
                    <span>FAQs</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#evaluaciones" data-section="evaluaciones">
                    <i class="bi bi-star-fill"></i>
                    <span>Evaluaciones</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#inventario" data-section="inventario">
                    <i class="bi bi-box-seam"></i>
                    <span>Inventario</span>
                </a>
            </li>
            <li class="nav-item mt-auto">
                <a class="nav-link text-danger" href="#" id="logoutBtn">
                    <i class="bi bi-box-arrow-right"></i>
                    <span>Cerrar Sesión</span>
                </a>
            </li>
        </ul>
    </nav>

    <!-- Toast container for notifications -->
    <div id="toastContainer" class="toast-container position-fixed top-0 end-0 p-3" style="z-index: 1100;"></div>
    
    <!-- Main Content -->
    <main class="main-content">
        <!-- Header -->
        <header class="content-header">
            <button class="btn btn-outline-secondary d-md-none me-3" id="sidebarToggleMobile">
                <i class="bi bi-list"></i>
            </button>
            <h1 id="pageTitle">Dashboard</h1>
        </header>

        <!-- Content Sections -->
        <div class="content-body">
            <!-- Dashboard Section -->
            <section id="dashboard-section" class="content-section active">
                <div class="row mb-4">
                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="card border-left-primary shadow h-100 py-2">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                            Total Pacientes</div>
                                        <div class="h5 mb-0 font-weight-bold text-gray-800" id="totalPacientes">0</div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="bi bi-people fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="card border-left-success shadow h-100 py-2">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-success text-uppercase mb-1">
                                            Citas Hoy</div>
                                        <div class="h5 mb-0 font-weight-bold text-gray-800" id="citasHoy">0</div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="bi bi-calendar-check fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="card border-left-info shadow h-100 py-2">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-info text-uppercase mb-1">
                                            Ingresos Mes</div>
                                        <div class="h5 mb-0 font-weight-bold text-gray-800" id="ingresosMes">$0</div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="bi bi-currency-dollar fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="card border-left-warning shadow h-100 py-2">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">
                                            Odontólogos Activos</div>
                                        <div class="h5 mb-0 font-weight-bold text-gray-800" id="odontologosActivos">0</div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="bi bi-person-badge fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-lg-8">
                        <div class="card shadow mb-4">
                            <div class="card-header py-3">
                                <h6 class="m-0 font-weight-bold text-primary">Citas por Mes</h6>
                            </div>
                            <div class="card-body">
                                <canvas id="citasChart"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <div class="card shadow mb-4">
                            <div class="card-header py-3">
                                <h6 class="m-0 font-weight-bold text-primary">Próximas Citas</h6>
                            </div>
                            <div class="card-body">
                                <div id="proximasCitas" class="list-group list-group-flush">
                                    <!-- Se carga dinámicamente -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Usuarios Section -->
            <section id="usuarios-section" class="content-section">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2>Gestión de Usuarios</h2>
                    <button class="btn btn-primary" id="addUserBtn">
                        <i class="bi bi-plus-circle"></i> Nuevo Usuario
                    </button>
                </div>
                
                <div class="card shadow">
                    <div class="card-header">
                        <div class="row align-items-center">
                            <div class="col">
                                <h6 class="m-0">Lista de Usuarios</h6>
                            </div>
                            <div class="col-auto">
                                <div class="input-group">
                                    <input type="text" class="form-control" placeholder="Buscar usuario..." id="searchUser">
                                    <button class="btn btn-outline-secondary" type="button">
                                        <i class="bi bi-search"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover" id="usuariosTable">
                                <thead class="table-dark">
                                    <tr>
                                        <th>ID</th>
                                        <th>Nombre</th>
                                        <th>Email</th>
                                        <th>Rol</th>
                                        <th>Estado</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Se carga dinámicamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Citas Section -->
            <section id="citas-section" class="content-section">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2>Gestión de Citas</h2>
                    <div class="d-flex gap-2">
                        <div class="btn-group" role="group">
                            <button class="btn btn-outline-secondary" id="vistaTablaBtn">
                                <i class="bi bi-table"></i> Tabla
                            </button>
                            <button class="btn btn-outline-secondary" id="vistaCalendarioBtn">
                                <i class="bi bi-calendar3"></i> Calendario
                            </button>
                        </div>
                        <div class="btn-group" role="group">
                            <button class="btn btn-outline-danger" id="exportCitasPdfBtn">
                                <i class="bi bi-file-earmark-pdf"></i> PDF
                            </button>
                            <button class="btn btn-outline-success" id="exportCitasExcelBtn">
                                <i class="bi bi-file-earmark-excel"></i> Excel
                            </button>
                        </div>
                        <button class="btn btn-outline-info" id="historialGeneralBtn">
                            <i class="bi bi-clock-history"></i> Historial
                        </button>
                        <button class="btn btn-outline-primary" id="refreshCitasBtn">
                            <i class="bi bi-arrow-clockwise"></i> Actualizar
                        </button>
                        <div class="btn-group" role="group">
                            <button class="btn btn-outline-secondary dropdown-toggle" id="debugCitasBtn" data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="bi bi-bug"></i> Debug
                            </button>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item" href="#" onclick="debugCitas()">
                                    <i class="bi bi-search"></i> Diagnóstico General
                                </a></li>
                                <li><a class="dropdown-item" href="#" onclick="testApiEndpoints()">
                                    <i class="bi bi-wifi"></i> Test API Endpoints
                                </a></li>
                                <li><a class="dropdown-item" href="#" onclick="checkDatabaseConnection()">
                                    <i class="bi bi-database"></i> Test Base de Datos
                                </a></li>
                                <li><a class="dropdown-item" href="#" onclick="validateDataIntegrity()">
                                    <i class="bi bi-shield-check"></i> Validar Integridad
                                </a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="#" onclick="generateTestData()">
                                    <i class="bi bi-plus-circle"></i> Generar Datos Test
                                </a></li>
                                <li><a class="dropdown-item" href="#" onclick="clearDebugLog()">
                                    <i class="bi bi-trash"></i> Limpiar Log
                                </a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="row mb-4">
                    <div class="col-md-3">
                        <label class="form-label">Filtrar por fecha:</label>
                        <input type="date" class="form-control" id="fechaFiltro">
                    </div>
                    <div class="col-md-3">
                        <label class="form-label">Estado:</label>
                        <select class="form-select" id="estadoFiltro">
                            <option value="">Todos</option>
                            <option value="programada">Programada</option>
                            <option value="confirmada">Confirmada</option>
                            <option value="completada">Completada</option>
                            <option value="cancelada">Cancelada</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <label class="form-label">Buscar paciente:</label>
                        <input type="text" class="form-control" id="pacienteFiltro" placeholder="Nombre del paciente">
                    </div>
                    <div class="col-md-3">
                        <label class="form-label">Buscar odontólogo:</label>
                        <input type="text" class="form-control" id="odontologoFiltro" placeholder="Nombre del odontólogo">
                    </div>
                </div>

                <!-- Status area for citas -->
                <div id="citasStatus" class="mb-3"></div>

                <!-- Debug Panel -->
                <div id="debugPanel" class="card mb-4" style="display: none;">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="mb-0">
                            <i class="bi bi-bug-fill text-warning"></i> Panel de Debug
                        </h5>
                        <button class="btn btn-sm btn-outline-secondary" onclick="toggleDebugPanel()">
                            <i class="bi bi-x-lg"></i>
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h6>Estado del Sistema</h6>
                                <div id="systemStatus" class="mb-3">
                                    <div class="d-flex justify-content-between">
                                        <span>API Server:</span>
                                        <span id="apiStatus" class="badge bg-secondary">Checking...</span>
                                    </div>
                                    <div class="d-flex justify-content-between">
                                        <span>Database:</span>
                                        <span id="dbStatus" class="badge bg-secondary">Checking...</span>
                                    </div>
                                    <div class="d-flex justify-content-between">
                                        <span>Auto-refresh:</span>
                                        <span id="refreshStatus" class="badge bg-secondary">Checking...</span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h6>Estadísticas</h6>
                                <div id="debugStats" class="mb-3">
                                    <div class="d-flex justify-content-between">
                                        <span>Total Citas:</span>
                                        <span id="totalCitas" class="badge bg-info">-</span>
                                    </div>
                                    <div class="d-flex justify-content-between">
                                        <span>Citas Hoy:</span>
                                        <span id="citasHoy" class="badge bg-primary">-</span>
                                    </div>
                                    <div class="d-flex justify-content-between">
                                        <span>Última Actualización:</span>
                                        <span id="lastUpdate" class="badge bg-success">-</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12">
                                <h6>Log de Debug</h6>
                                <div id="debugLog" class="border rounded p-2" style="height: 200px; overflow-y: auto; background-color: #f8f9fa; font-family: monospace; font-size: 0.875em;">
                                    <!-- Debug messages will appear here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card shadow" id="citasTablaView">
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover" id="citasTable">
                                <thead class="table-dark">
                                    <tr>
                                        <th>ID</th>
                                        <th>Paciente</th>
                                        <th>Odontólogo</th>
                                        <th>Fecha</th>
                                        <th>Hora</th>
                                        <th>Estado</th>
                                        <th>Motivo</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody id="citasTableBody">
                                    <!-- Se carga dinámicamente -->
                                </tbody>
                            </table>
                        </div>
                        <div id="citasLoadingMsg" class="text-center py-4">
                            <div class="spinner-border text-primary" role="status">
                                <span class="visually-hidden">Cargando...</span>
                            </div>
                            <p class="mt-2">Cargando citas...</p>
                        </div>
                        <div id="noCitasMsg" class="text-center py-4 d-none">
                            <i class="bi bi-calendar-x display-4 text-muted"></i>
                            <p class="mt-2 text-muted">No se encontraron citas</p>
                        </div>
                    </div>
                </div>

                <!-- Vista de Calendario -->
                <div class="card shadow d-none" id="citasCalendarioView">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <div class="d-flex align-items-center">
                                <button class="btn btn-outline-secondary btn-sm me-2" id="calendarioPrevBtn">
                                    <i class="bi bi-chevron-left"></i>
                                </button>
                                <h5 class="mb-0" id="calendarioMesAno">Agosto 2025</h5>
                                <button class="btn btn-outline-secondary btn-sm ms-2" id="calendarioNextBtn">
                                    <i class="bi bi-chevron-right"></i>
                                </button>
                            </div>
                            <button class="btn btn-outline-primary btn-sm" id="calendarioHoyBtn">Hoy</button>
                        </div>
                        
                        <div class="table-responsive">
                            <table class="table table-bordered" id="calendarioTable">
                                <thead class="table-light">
                                    <tr>
                                        <th class="text-center">Dom</th>
                                        <th class="text-center">Lun</th>
                                        <th class="text-center">Mar</th>
                                        <th class="text-center">Mié</th>
                                        <th class="text-center">Jue</th>
                                        <th class="text-center">Vie</th>
                                        <th class="text-center">Sáb</th>
                                    </tr>
                                </thead>
                                <tbody id="calendarioBody">
                                    <!-- Se genera dinámicamente -->
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="row mt-3">
                            <div class="col-md-12">
                                <small class="text-muted">
                                    <i class="bi bi-circle-fill text-primary me-1"></i> Programada
                                    <i class="bi bi-circle-fill text-info me-1 ms-2"></i> Confirmada
                                    <i class="bi bi-circle-fill text-success me-1 ms-2"></i> Completada
                                    <i class="bi bi-circle-fill text-danger me-1 ms-2"></i> Cancelada
                                </small>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Reportes Section -->
            <section id="reportes-section" class="content-section">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2>Reportes y Estadísticas</h2>
                    <div>
                        <button class="btn btn-primary me-2" id="generarReporteBtn">
                            <i class="bi bi-graph-up"></i> Generar Reporte
                        </button>
                        <div class="btn-group" role="group">
                            <button class="btn btn-danger btn-sm" id="exportPdfBtn">
                                <i class="bi bi-file-earmark-pdf"></i> PDF
                            </button>
                            <button class="btn btn-success btn-sm" id="exportExcelBtn">
                                <i class="bi bi-file-earmark-excel"></i> Excel
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Filtros de Reporte -->
                <div class="card shadow mb-4">
                    <div class="card-header" data-bs-toggle="collapse" data-bs-target="#filtrosReporte" aria-expanded="false" aria-controls="filtrosReporte" style="cursor: pointer;">
                        <h6 class="m-0 font-weight-bold text-primary d-flex justify-content-between align-items-center">
                            <span><i class="bi bi-funnel"></i> Filtros de Reporte</span>
                            <i class="bi bi-chevron-down"></i>
                        </h6>
                    </div>
                    <div class="collapse" id="filtrosReporte">
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-3">
                                    <label class="form-label">Tipo de Reporte</label>
                                    <select class="form-select form-select-sm" id="tipoReporte">
                                        <option value="general">Reporte General</option>
                                        <option value="ingresos">Ingresos y Pagos</option>
                                        <option value="citas">Citas y Tratamientos</option>
                                        <option value="pacientes">Análisis de Pacientes</option>
                                        <option value="odontologos">Rendimiento Odontólogos</option>
                                    </select>
                                </div>
                                <div class="col-md-2">
                                    <label class="form-label">Fecha Desde</label>
                                    <input type="date" class="form-control form-control-sm" id="fechaDesde">
                                </div>
                                <div class="col-md-2">
                                    <label class="form-label">Fecha Hasta</label>
                                    <input type="date" class="form-control form-control-sm" id="fechaHasta">
                                </div>
                                <div class="col-md-2">
                                    <label class="form-label">Sede</label>
                                    <select class="form-select form-select-sm" id="filtroSedereporte">
                                        <option value="">Todas las sedes</option>
                                    </select>
                                </div>
                                <div class="col-md-2">
                                    <label class="form-label">Estado</label>
                                    <select class="form-select form-select-sm" id="filtroEstado">
                                        <option value="">Todos los estados</option>
                                        <option value="completado">Completado</option>
                                        <option value="pendiente">Pendiente</option>
                                        <option value="cancelado">Cancelado</option>
                                    </select>
                                </div>
                                <div class="col-md-1 d-flex align-items-end">
                                    <button class="btn btn-primary btn-sm w-100" id="aplicarFiltrosBtn">
                                        <i class="bi bi-search"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tabs para diferentes tipos de reportes -->
                <ul class="nav nav-tabs mb-4" id="reportesTab" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="dashboard-tab" data-bs-toggle="tab" data-bs-target="#dashboard-reportes" type="button" role="tab" aria-controls="dashboard-reportes" aria-selected="true">
                            Dashboard
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="financiero-tab" data-bs-toggle="tab" data-bs-target="#financiero-reportes" type="button" role="tab" aria-controls="financiero-reportes" aria-selected="false">
                            Financiero
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="operativo-tab" data-bs-toggle="tab" data-bs-target="#operativo-reportes" type="button" role="tab" aria-controls="operativo-reportes" aria-selected="false">
                            Operativo
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="detallado-tab" data-bs-toggle="tab" data-bs-target="#detallado-reportes" type="button" role="tab" aria-controls="detallado-reportes" aria-selected="false">
                            Reportes Detallados
                        </button>
                    </li>
                </ul>

                <!-- Contenido de los tabs -->
                <div class="tab-content" id="reportesTabContent">
                    <!-- Dashboard Tab -->
                    <div class="tab-pane fade show active" id="dashboard-reportes" role="tabpanel" aria-labelledby="dashboard-tab">
                        <!-- Métricas principales -->
                        <div class="row mb-4">
                            <div class="col-xl-3 col-md-6">
                                <div class="card bg-primary text-white shadow">
                                    <div class="card-body">
                                        <div class="row no-gutters align-items-center">
                                            <div class="col mr-2">
                                                <div class="text-xs font-weight-bold text-uppercase mb-1">
                                                    Ingresos Totales
                                                </div>
                                                <div class="h5 mb-0 font-weight-bold" id="totalIngresos">$0</div>
                                            </div>
                                            <div class="col-auto">
                                                <i class="bi bi-currency-dollar fa-2x text-gray-300"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-3 col-md-6">
                                <div class="card bg-success text-white shadow">
                                    <div class="card-body">
                                        <div class="row no-gutters align-items-center">
                                            <div class="col mr-2">
                                                <div class="text-xs font-weight-bold text-uppercase mb-1">
                                                    Citas Completadas
                                                </div>
                                                <div class="h5 mb-0 font-weight-bold" id="totalCitas">0</div>
                                            </div>
                                            <div class="col-auto">
                                                <i class="bi bi-calendar-check fa-2x text-gray-300"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-3 col-md-6">
                                <div class="card bg-info text-white shadow">
                                    <div class="card-body">
                                        <div class="row no-gutters align-items-center">
                                            <div class="col mr-2">
                                                <div class="text-xs font-weight-bold text-uppercase mb-1">
                                                    Pacientes Activos
                                                </div>
                                                <div class="h5 mb-0 font-weight-bold" id="totalPacientes">0</div>
                                            </div>
                                            <div class="col-auto">
                                                <i class="bi bi-people fa-2x text-gray-300"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-3 col-md-6">
                                <div class="card bg-warning text-white shadow">
                                    <div class="card-body">
                                        <div class="row no-gutters align-items-center">
                                            <div class="col mr-2">
                                                <div class="text-xs font-weight-bold text-uppercase mb-1">
                                                    Tratamientos Activos
                                                </div>
                                                <div class="h5 mb-0 font-weight-bold" id="totalTratamientos">0</div>
                                            </div>
                                            <div class="col-auto">
                                                <i class="bi bi-clipboard-pulse fa-2x text-gray-300"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Gráficos principales -->
                        <div class="row mb-4">
                            <div class="col-lg-6">
                                <div class="card shadow">
                                    <div class="card-header">
                                        <h6 class="m-0 font-weight-bold text-primary">Ingresos por Mes</h6>
                                    </div>
                                    <div class="card-body">
                                        <canvas id="ingresosChart" width="100" height="50"></canvas>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="card shadow">
                                    <div class="card-header">
                                        <h6 class="m-0 font-weight-bold text-primary">Distribución de Tratamientos</h6>
                                    </div>
                                    <div class="card-body">
                                        <canvas id="tratamientosChart" width="100" height="50"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Tendencias recientes -->
                        <div class="row">
                            <div class="col-lg-8">
                                <div class="card shadow">
                                    <div class="card-header">
                                        <h6 class="m-0 font-weight-bold text-primary">Tendencia de Citas (Últimos 30 días)</h6>
                                    </div>
                                    <div class="card-body">
                                        <canvas id="tendenciaCitasChart" width="100" height="30"></canvas>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="card shadow">
                                    <div class="card-header">
                                        <h6 class="m-0 font-weight-bold text-primary">Top Tratamientos</h6>
                                    </div>
                                    <div class="card-body">
                                        <div id="topTratamientosList">
                                            <!-- Se carga dinámicamente -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Financiero Tab -->
                    <div class="tab-pane fade" id="financiero-reportes" role="tabpanel" aria-labelledby="financiero-tab">
                        <div class="row mb-4">
                            <div class="col-lg-8">
                                <div class="card shadow">
                                    <div class="card-header d-flex justify-content-between align-items-center">
                                        <h6 class="m-0 font-weight-bold text-primary">Análisis de Ingresos</h6>
                                        <select class="form-select form-select-sm" style="width: auto;" id="periodoFinanciero">
                                            <option value="mensual">Mensual</option>
                                            <option value="semanal">Semanal</option>
                                            <option value="anual">Anual</option>
                                        </select>
                                    </div>
                                    <div class="card-body">
                                        <canvas id="analisisIngresosChart" width="100" height="40"></canvas>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="card shadow">
                                    <div class="card-header">
                                        <h6 class="m-0 font-weight-bold text-primary">Métodos de Pago</h6>
                                    </div>
                                    <div class="card-body">
                                        <canvas id="metodosPagoChart" width="100" height="50"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Tabla de ingresos detallados -->
                        <div class="card shadow">
                            <div class="card-header">
                                <h6 class="m-0 font-weight-bold text-primary">Detalle de Ingresos</h6>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-bordered table-hover" id="ingresosDetalleTable">
                                        <thead>
                                            <tr>
                                                <th>Fecha</th>
                                                <th>Concepto</th>
                                                <th>Paciente</th>
                                                <th>Método de Pago</th>
                                                <th>Monto</th>
                                                <th>Estado</th>
                                            </tr>
                                        </thead>
                                        <tbody id="ingresosDetalleTableBody">
                                            <!-- Se carga dinámicamente -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Operativo Tab -->
                    <div class="tab-pane fade" id="operativo-reportes" role="tabpanel" aria-labelledby="operativo-tab">
                        <div class="row mb-4">
                            <div class="col-lg-6">
                                <div class="card shadow">
                                    <div class="card-header">
                                        <h6 class="m-0 font-weight-bold text-primary">Estado de Citas</h6>
                                    </div>
                                    <div class="card-body">
                                        <canvas id="estadoCitasChart" width="100" height="50"></canvas>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="card shadow">
                                    <div class="card-header">
                                        <h6 class="m-0 font-weight-bold text-primary">Rendimiento por Sede</h6>
                                    </div>
                                    <div class="card-body">
                                        <canvas id="rendimientoSedeChart" width="100" height="50"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Estadísticas operativas -->
                        <div class="card shadow">
                            <div class="card-header">
                                <h6 class="m-0 font-weight-bold text-primary">Estadísticas Operativas</h6>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-striped" id="estadisticasOperativasTable">
                                        <thead>
                                            <tr>
                                                <th>Métrica</th>
                                                <th>Valor Actual</th>
                                                <th>Período Anterior</th>
                                                <th>Cambio</th>
                                                <th>Tendencia</th>
                                            </tr>
                                        </thead>
                                        <tbody id="estadisticasOperativasTableBody">
                                            <!-- Se carga dinámicamente -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Reportes Detallados Tab -->
                    <div class="tab-pane fade" id="detallado-reportes" role="tabpanel" aria-labelledby="detallado-tab">
                        <div class="card shadow">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h6 class="m-0 font-weight-bold text-primary">Reportes Personalizados</h6>
                                <button class="btn btn-sm btn-primary" id="configurarReporteBtn">
                                    <i class="bi bi-gear"></i> Configurar Reporte
                                </button>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-3">
                                        <h6 class="font-weight-bold">Reportes Disponibles</h6>
                                        <div class="list-group" id="reportesDisponibles">
                                            <button type="button" class="list-group-item list-group-item-action active" data-reporte="general">
                                                Reporte General
                                            </button>
                                            <button type="button" class="list-group-item list-group-item-action" data-reporte="pacientes-detalle">
                                                Detalle de Pacientes
                                            </button>
                                            <button type="button" class="list-group-item list-group-item-action" data-reporte="tratamientos-detalle">
                                                Tratamientos por Período
                                            </button>
                                            <button type="button" class="list-group-item list-group-item-action" data-reporte="odontologos-rendimiento">
                                                Rendimiento Odontólogos
                                            </button>
                                            <button type="button" class="list-group-item list-group-item-action" data-reporte="inventario-rotacion">
                                                Rotación de Inventario
                                            </button>
                                        </div>
                                    </div>
                                    <div class="col-md-9">
                                        <div id="reporteDetalladoContent">
                                            <div class="text-center">
                                                <p class="text-muted">Selecciona un reporte de la lista para ver los detalles</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- FAQs Section -->
            <section id="faqs-section" class="content-section">
                <div class="container-fluid">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h2><i class="bi bi-question-circle text-info"></i> Preguntas Frecuentes</h2>
                        <div>
                            <button class="btn btn-success me-2" id="addFaqBtn">
                                <i class="bi bi-plus-lg"></i> Nueva FAQ
                            </button>
                            <button class="btn btn-info" id="refreshFaqsBtn">
                                <i class="bi bi-arrow-clockwise"></i> Actualizar
                            </button>
                        </div>
                    </div>

                    <!-- Estadísticas de FAQs -->
                    <div class="row mb-4">
                        <div class="col-md-3">
                            <div class="card bg-primary text-white">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between">
                                        <div>
                                            <h4 id="faqsCount">0</h4>
                                            <p>Total FAQs</p>
                                        </div>
                                        <i class="bi bi-question-circle fs-1 opacity-50"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card bg-success text-white">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between">
                                        <div>
                                            <h4 id="faqsGeneralCount">0</h4>
                                            <p>Generales</p>
                                        </div>
                                        <i class="bi bi-info-circle fs-1 opacity-50"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card bg-warning text-white">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between">
                                        <div>
                                            <h4 id="faqsCitasCount">0</h4>
                                            <p>Citas</p>
                                        </div>
                                        <i class="bi bi-calendar-check fs-1 opacity-50"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card bg-info text-white">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between">
                                        <div>
                                            <h4 id="faqsPagosCount">0</h4>
                                            <p>Pagos</p>
                                        </div>
                                        <i class="bi bi-cash-coin fs-1 opacity-50"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tabla de FAQs -->
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0">Lista de Preguntas Frecuentes</h5>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-striped table-hover" id="faqsTable">
                                    <thead class="table-dark">
                                        <tr>
                                            <th>ID</th>
                                            <th>Pregunta</th>
                                            <th>Categoría</th>
                                            <th>Acciones</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td colspan="4" class="text-center">
                                                <div class="spinner-border text-primary" role="status">
                                                    <span class="visually-hidden">Cargando FAQs...</span>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Evaluaciones Section -->
            <section id="evaluaciones-section" class="content-section">
                <div class="container-fluid">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h2><i class="bi bi-star-fill text-warning"></i> Sistema de Evaluaciones</h2>
                        <button class="btn btn-info" id="reporteEvaluacionesBtn">
                            <i class="bi bi-graph-up"></i> Reporte de Evaluaciones
                        </button>
                    </div>
                    
                    <!-- Estadísticas generales -->
                    <div class="row mb-4">
                        <div class="col-lg-3 col-md-6 mb-3">
                            <div class="card text-white bg-primary">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between">
                                        <div>
                                            <h4 class="card-title" id="totalEvaluaciones">0</h4>
                                            <p class="card-text">Total Evaluaciones</p>
                                        </div>
                                        <i class="bi bi-star-fill fs-1 opacity-50"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-6 mb-3">
                            <div class="card text-white bg-success">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between">
                                        <div>
                                            <h4 class="card-title" id="promedioServicio">0.0</h4>
                                            <p class="card-text">Promedio Servicio</p>
                                        </div>
                                        <i class="bi bi-hand-thumbs-up fs-1 opacity-50"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-6 mb-3">
                            <div class="card text-white bg-warning">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between">
                                        <div>
                                            <h4 class="card-title" id="promedioOdontologo">0.0</h4>
                                            <p class="card-text">Promedio Odontólogos</p>
                                        </div>
                                        <i class="bi bi-person-check fs-1 opacity-50"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-6 mb-3">
                            <div class="card text-white bg-info">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between">
                                        <div>
                                            <h4 class="card-title" id="porcentajeRecomendacion">0%</h4>
                                            <p class="card-text">% Recomendaciones</p>
                                        </div>
                                        <i class="bi bi-heart-fill fs-1 opacity-50"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Tabla de evaluaciones -->
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0">Todas las Evaluaciones</h5>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-striped table-hover" id="evaluacionesTable">
                                    <thead class="table-dark">
                                        <tr>
                                            <th>ID</th>
                                            <th>Paciente</th>
                                            <th>Odontólogo</th>
                                            <th>Calificación</th>
                                            <th>Recomienda</th>
                                            <th>Fecha/Acciones</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td colspan="6" class="text-center">
                                                <div class="spinner-border text-primary" role="status">
                                                    <span class="visually-hidden">Cargando evaluaciones...</span>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Inventario Section -->
            <section id="inventario-section" class="content-section">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2>Inventario y Sedes</h2>
                    <div>
                        <button class="btn btn-primary me-2" id="generarReporteInventarioBtn">
                            <i class="bi bi-file-text"></i> Generar Reporte
                        </button>
                        <button class="btn btn-success me-2" id="addInventarioBtn">
                            <i class="bi bi-plus-circle"></i> Nuevo Item
                        </button>
                    </div>
                </div>

                <!-- Alertas de Stock Bajo -->
                <div id="alertasInventario" class="mb-4" style="display: none;">
                    <div class="alert alert-warning d-flex align-items-center" role="alert">
                        <i class="bi bi-exclamation-triangle-fill me-2"></i>
                        <div>
                            <strong>Alertas de Inventario:</strong> <span id="contadorAlertas">0</span> productos con stock bajo
                            <button class="btn btn-sm btn-outline-warning ms-2" id="verAlertasBtn">Ver Detalles</button>
                        </div>
                    </div>
                </div>

                <!-- Tabs para diferentes vistas -->
                <ul class="nav nav-tabs mb-4" id="inventarioTab" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="equipos-tab" data-bs-toggle="tab" data-bs-target="#equipos-inventario" type="button" role="tab" aria-controls="equipos-inventario" aria-selected="true">
                            <i class="bi bi-box-seam"></i> Equipos e Insumos
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="sedes-tab" data-bs-toggle="tab" data-bs-target="#sedes-gestion" type="button" role="tab" aria-controls="sedes-gestion" aria-selected="false">
                            <i class="bi bi-building"></i> Gestión de Sedes
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="movimientos-tab" data-bs-toggle="tab" data-bs-target="#movimientos-inventario" type="button" role="tab" aria-controls="movimientos-inventario" aria-selected="false">
                            <i class="bi bi-arrow-left-right"></i> Movimientos
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="categorias-tab" data-bs-toggle="tab" data-bs-target="#categorias-inventario" type="button" role="tab" aria-controls="categorias-inventario" aria-selected="false">
                            <i class="bi bi-tags"></i> Categorías
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="proveedores-tab" data-bs-toggle="tab" data-bs-target="#proveedores-inventario" type="button" role="tab" aria-controls="proveedores-inventario" aria-selected="false">
                            <i class="bi bi-truck"></i> Proveedores
                        </button>
                    </li>
                </ul>

                <!-- Contenido de los tabs -->
                <div class="tab-content" id="inventarioTabContent">
                    <!-- Equipos e Insumos Tab -->
                    <div class="tab-pane fade show active" id="equipos-inventario" role="tabpanel" aria-labelledby="equipos-tab">
                        <!-- Filtros y búsqueda -->
                        <div class="card shadow mb-4">
                            <div class="card-header" data-bs-toggle="collapse" data-bs-target="#filtrosInventario" aria-expanded="false" aria-controls="filtrosInventario" style="cursor: pointer;">
                                <h6 class="m-0 font-weight-bold text-primary d-flex justify-content-between align-items-center">
                                    <span><i class="bi bi-funnel"></i> Filtros de Búsqueda</span>
                                    <i class="bi bi-chevron-down"></i>
                                </h6>
                            </div>
                            <div class="collapse" id="filtrosInventario">
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <label class="form-label">Buscar Producto</label>
                                            <div class="input-group input-group-sm">
                                                <input type="text" class="form-control" id="buscarInventario" placeholder="Nombre o código...">
                                                <button class="btn btn-outline-secondary" type="button" id="buscarInventarioBtn">
                                                    <i class="bi bi-search"></i>
                                                </button>
                                            </div>
                                        </div>
                                        <div class="col-md-2">
                                            <label class="form-label">Categoría</label>
                                            <select class="form-select form-select-sm" id="filtroCategoria">
                                                <option value="">Todas</option>
                                            </select>
                                        </div>
                                        <div class="col-md-2">
                                            <label class="form-label">Sede</label>
                                            <select class="form-select form-select-sm" id="filtroSedeInventario">
                                                <option value="">Todas las sedes</option>
                                            </select>
                                        </div>
                                        <div class="col-md-2">
                                            <label class="form-label">Estado Stock</label>
                                            <select class="form-select form-select-sm" id="filtroStock">
                                                <option value="">Todos</option>
                                                <option value="normal">Stock Normal</option>
                                                <option value="bajo">Stock Bajo</option>
                                                <option value="agotado">Agotado</option>
                                                <option value="exceso">Exceso</option>
                                            </select>
                                        </div>
                                        <div class="col-md-2 d-flex align-items-end">
                                            <button class="btn btn-primary btn-sm w-100" id="aplicarFiltrosInventario">
                                                <i class="bi bi-funnel"></i> Filtrar
                                            </button>
                                        </div>
                                        <div class="col-md-1 d-flex align-items-end">
                                            <button class="btn btn-secondary btn-sm w-100" id="limpiarFiltrosInventario">
                                                <i class="bi bi-x"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Resumen de inventario -->
                        <div class="row mb-4">
                            <div class="col-lg-3">
                                <div class="card bg-primary text-white shadow">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between">
                                            <div>
                                                <div class="text-xs font-weight-bold text-uppercase mb-1">
                                                    Total Productos
                                                </div>
                                                <div class="h5 mb-0" id="totalProductos">0</div>
                                            </div>
                                            <div class="col-auto">
                                                <i class="bi bi-box fa-2x text-gray-300"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-3">
                                <div class="card bg-success text-white shadow">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between">
                                            <div>
                                                <div class="text-xs font-weight-bold text-uppercase mb-1">
                                                    Valor Total Stock
                                                </div>
                                                <div class="h5 mb-0" id="valorTotalStock">$0</div>
                                            </div>
                                            <div class="col-auto">
                                                <i class="bi bi-currency-dollar fa-2x text-gray-300"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-3">
                                <div class="card bg-warning text-white shadow">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between">
                                            <div>
                                                <div class="text-xs font-weight-bold text-uppercase mb-1">
                                                    Stock Bajo
                                                </div>
                                                <div class="h5 mb-0" id="productosStockBajo">0</div>
                                            </div>
                                            <div class="col-auto">
                                                <i class="bi bi-exclamation-triangle fa-2x text-gray-300"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-3">
                                <div class="card bg-danger text-white shadow">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between">
                                            <div>
                                                <div class="text-xs font-weight-bold text-uppercase mb-1">
                                                    Productos Agotados
                                                </div>
                                                <div class="h5 mb-0" id="productosAgotados">0</div>
                                            </div>
                                            <div class="col-auto">
                                                <i class="bi bi-x-circle fa-2x text-gray-300"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Tabla de inventario -->
                        <div class="card shadow">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h6 class="m-0 font-weight-bold text-primary">
                                    <i class="bi bi-box-seam"></i> Inventario de Equipos e Insumos
                                </h6>
                                <div>
                                    <button class="btn btn-sm btn-info me-2" id="exportarInventarioBtn">
                                        <i class="bi bi-download"></i> Exportar
                                    </button>
                                    <button class="btn btn-sm btn-success" id="importarInventarioBtn">
                                        <i class="bi bi-upload"></i> Importar
                                    </button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover" id="inventarioTable">
                                        <thead class="table-dark">
                                            <tr>
                                                <th>
                                                    <input type="checkbox" id="selectAllInventario">
                                                </th>
                                                <th>Código</th>
                                                <th>Producto</th>
                                                <th>Categoría</th>
                                                <th>Sede</th>
                                                <th>Stock Actual</th>
                                                <th>Stock Mínimo</th>
                                                <th>Precio Unit.</th>
                                                <th>Valor Total</th>
                                                <th>Estado</th>
                                                <th>Última Act.</th>
                                                <th>Acciones</th>
                                            </tr>
                                        </thead>
                                        <tbody id="inventarioTableBody">
                                            <tr>
                                                <td colspan="12" class="text-center">
                                                    <div class="spinner-border text-primary" role="status">
                                                        <span class="visually-hidden">Cargando inventario...</span>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                
                                <!-- Paginación -->
                                <div class="d-flex justify-content-between align-items-center mt-3">
                                    <div>
                                        <select id="inventarioPerPage" class="form-select form-select-sm" style="width: auto;">
                                            <option value="10">10 por página</option>
                                            <option value="25">25 por página</option>
                                            <option value="50">50 por página</option>
                                            <option value="100">100 por página</option>
                                        </select>
                                    </div>
                                    <div>
                                        <span class="text-muted">Mostrando <span id="inventarioStart">1</span> - <span id="inventarioEnd">10</span> de <span id="inventarioTotal">0</span> productos</span>
                                    </div>
                                    <nav>
                                        <ul class="pagination pagination-sm mb-0" id="inventarioPagination">
                                            <!-- Paginación generada dinámicamente -->
                                        </ul>
                                    </nav>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Gestión de Sedes Tab -->
                    <div class="tab-pane fade" id="sedes-gestion" role="tabpanel" aria-labelledby="sedes-tab">
                        <div class="row">
                            <!-- Lista de sedes -->
                            <div class="col-12">
                                <div class="card shadow">
                                    <div class="card-header d-flex justify-content-between align-items-center">
                                        <h6 class="m-0 font-weight-bold text-primary">
                                            <i class="bi bi-building"></i> Sedes Registradas
                                        </h6>
                                    </div>
                                    <div class="card-body">
                                        <div id="sedesGrid" class="row">
                                            <!-- Las sedes se cargan dinámicamente -->
                                            <div class="col-12 text-center">
                                                <div class="spinner-border text-primary" role="status">
                                                    <span class="visually-hidden">Cargando sedes...</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Movimientos Tab -->
                    <div class="tab-pane fade" id="movimientos-inventario" role="tabpanel" aria-labelledby="movimientos-tab">
                        <div class="row mb-4">
                            <div class="col-lg-8">
                                <div class="card shadow">
                                    <div class="card-header">
                                        <h6 class="m-0 font-weight-bold text-primary">
                                            <i class="bi bi-plus-circle"></i> Registrar Movimiento
                                        </h6>
                                    </div>
                                    <div class="card-body">
                                        <form id="movimientoForm">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="mb-3">
                                                        <label class="form-label">Tipo de Movimiento</label>
                                                        <select class="form-select" id="tipoMovimiento" required>
                                                            <option value="">Seleccionar...</option>
                                                            <option value="entrada">Entrada</option>
                                                            <option value="salida">Salida</option>
                                                            <option value="traslado">Traslado</option>
                                                            <option value="ajuste">Ajuste</option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="mb-3">
                                                        <label class="form-label">Producto</label>
                                                        <select class="form-select" id="productoMovimiento" required>
                                                            <option value="">Seleccionar producto...</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="mb-3">
                                                        <label class="form-label">Cantidad</label>
                                                        <input type="number" class="form-control" id="cantidadMovimiento" min="1" required>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="mb-3">
                                                        <label class="form-label">Sede</label>
                                                        <select class="form-select" id="sedeMovimiento" required>
                                                            <option value="">Seleccionar sede...</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="mb-3">
                                                <label class="form-label">Observaciones</label>
                                                <textarea class="form-control" id="observacionesMovimiento" rows="3" placeholder="Detalles del movimiento..."></textarea>
                                            </div>
                                            <button type="submit" class="btn btn-primary">
                                                <i class="bi bi-save"></i> Registrar Movimiento
                                            </button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Historial completo de movimientos -->
                        <div class="card shadow">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h6 class="m-0 font-weight-bold text-primary">
                                    <i class="bi bi-list-ul"></i> Historial de Movimientos
                                </h6>
                                <div>
                                    <input type="date" class="form-control form-control-sm d-inline-block" id="fechaFiltroMovimientos" style="width: auto;">
                                    <button class="btn btn-sm btn-outline-primary ms-2" id="filtrarMovimientosBtn">Filtrar</button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead>
                                            <tr>
                                                <th>Fecha</th>
                                                <th>Tipo</th>
                                                <th>Producto</th>
                                                <th>Cantidad</th>
                                                <th>Sede</th>
                                                <th>Usuario</th>
                                                <th>Observaciones</th>
                                            </tr>
                                        </thead>
                                        <tbody id="movimientosTableBody">
                                            <tr>
                                                <td colspan="7" class="text-center">
                                                    <div class="spinner-border text-primary" role="status">
                                                        <span class="visually-hidden">Cargando historial...</span>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Categorías Tab -->
                    <div class="tab-pane fade" id="categorias-inventario" role="tabpanel" aria-labelledby="categorias-tab">
                        <div class="row">
                            <div class="col-12">
                                <div class="card shadow">
                                    <div class="card-header d-flex justify-content-between align-items-center">
                                        <h6 class="m-0 font-weight-bold text-primary">
                                            <i class="bi bi-tags"></i> Categorías de Inventario
                                        </h6>
                                        <button class="btn btn-sm btn-success" id="nuevaCategoriaBtn">
                                            <i class="bi bi-plus-circle"></i> Nueva Categoría
                                        </button>
                                    </div>
                                    <div class="card-body">
                                        <div class="table-responsive">
                                            <table class="table table-hover">
                                                <thead>
                                                    <tr>
                                                        <th>ID</th>
                                                        <th>Nombre</th>
                                                        <th>Descripción</th>
                                                        <th>Productos</th>
                                                        <th>Color</th>
                                                        <th>Estado</th>
                                                        <th>Acciones</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="categoriasTableBody">
                                                    <tr>
                                                        <td colspan="7" class="text-center">
                                                            <div class="spinner-border text-primary" role="status">
                                                                <span class="visually-hidden">Cargando categorías...</span>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Proveedores Tab -->
                    <div class="tab-pane fade" id="proveedores-inventario" role="tabpanel" aria-labelledby="proveedores-tab">
                        <div class="card shadow">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h6 class="m-0 font-weight-bold text-primary">
                                    <i class="bi bi-truck"></i> Gestión de Proveedores
                                </h6>
                                <button class="btn btn-sm btn-success" id="nuevoProveedorBtn">
                                    <i class="bi bi-plus-circle"></i> Nuevo Proveedor
                                </button>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead>
                                            <tr>
                                                <th>ID</th>
                                                <th>Empresa</th>
                                                <th>Contacto</th>
                                                <th>Teléfono</th>
                                                <th>Email</th>
                                                <th>Productos</th>
                                                <th>Última Compra</th>
                                                <th>Estado</th>
                                                <th>Acciones</th>
                                            </tr>
                                        </thead>
                                        <tbody id="proveedoresTableBody">
                                            <tr>
                                                <td colspan="9" class="text-center">
                                                    <div class="spinner-border text-primary" role="status">
                                                        <span class="visually-hidden">Cargando proveedores...</span>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
            </section>
            
            <!-- Pagos y Facturación Section -->
            <section id="pagos-section" class="content-section">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2>Pagos y Facturación</h2>
                    <div>
                        <button class="btn btn-primary me-2" id="configServiciosBtn">
                            <i class="bi bi-gear-fill"></i> Configurar Servicios
                        </button>
                        <button class="btn btn-success" id="nuevaFacturaBtn">
                            <i class="bi bi-receipt"></i> Nueva Factura
                        </button>
                    </div>
                </div>

                <!-- Tabs para las diferentes secciones -->
                <ul class="nav nav-tabs mb-4" id="pagosTab" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="historial-tab" data-bs-toggle="tab" data-bs-target="#historial-pagos" type="button" role="tab" aria-controls="historial-pagos" aria-selected="true">
                            Historial de Pagos
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="servicios-tab" data-bs-toggle="tab" data-bs-target="#servicios-precios" type="button" role="tab" aria-controls="servicios-precios" aria-selected="false">
                            Servicios y Precios
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="metodos-tab" data-bs-toggle="tab" data-bs-target="#metodos-pago" type="button" role="tab" aria-controls="metodos-pago" aria-selected="false">
                            Métodos de Pago
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="pagos-odontologos-tab" data-bs-toggle="tab" data-bs-target="#pagos-odontologos" type="button" role="tab" aria-controls="pagos-odontologos" aria-selected="false">
                            <i class="fas fa-user-md"></i> Pagos a Odontólogos
                        </button>
                    </li>
                </ul>

                <!-- Contenido de los tabs -->
                <div class="tab-content" id="pagosTabContent">
                    <!-- Historial de Pagos Tab -->
                    <div class="tab-pane fade show active" id="historial-pagos" role="tabpanel" aria-labelledby="historial-tab">
                        <div class="card shadow mb-4">
                            <div class="card-header py-3 d-flex justify-content-between align-items-center">
                                <h6 class="m-0 font-weight-bold text-primary">Historial de Pagos</h6>
                                <div class="input-group" style="width: 300px;">
                                    <input type="text" id="searchPagos" class="form-control" placeholder="Buscar pago...">
                                    <button class="btn btn-outline-secondary" type="button" id="searchPagosBtn">
                                        <i class="bi bi-search"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-bordered table-hover" id="pagosTable" width="100%" cellspacing="0">
                                        <thead>
                                            <tr>
                                                <th>ID</th>
                                                <th>Fecha</th>
                                                <th>Paciente</th>
                                                <th>Concepto</th>
                                                <th>Monto</th>
                                                <th>Método</th>
                                                <th>Estado</th>
                                                <th>Acciones</th>
                                            </tr>
                                        </thead>
                                        <tbody id="pagosTableBody">
                                            <!-- Aquí se cargarán los datos dinámicamente -->
                                        </tbody>
                                    </table>
                                </div>
                                <div class="d-flex justify-content-between align-items-center mt-3">
                                    <div>
                                        <select id="pagosPerPage" class="form-select form-select-sm" aria-label="Pagos por página">
                                            <option value="10">10 por página</option>
                                            <option value="25">25 por página</option>
                                            <option value="50">50 por página</option>
                                            <option value="100">100 por página</option>
                                        </select>
                                    </div>
                                    <nav aria-label="Paginación de pagos">
                                        <ul class="pagination pagination-sm" id="pagosPagination">
                                            <!-- Paginación se genera dinámicamente -->
                                        </ul>
                                    </nav>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Servicios y Precios Tab -->
                    <div class="tab-pane fade" id="servicios-precios" role="tabpanel" aria-labelledby="servicios-tab">
                        <div class="card shadow mb-4">
                            <div class="card-header py-3 d-flex justify-content-between align-items-center">
                                <h6 class="m-0 font-weight-bold text-primary">Catálogo de Servicios y Precios</h6>
                                <button class="btn btn-sm btn-success" id="addServicioBtn">
                                    <i class="bi bi-plus-circle"></i> Nuevo Servicio
                                </button>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-bordered table-hover" id="serviciosTable" width="100%" cellspacing="0">
                                        <thead>
                                            <tr>
                                                <th>ID</th>
                                                <th>Servicio</th>
                                                <th>Categoría</th>
                                                <th>Precio Base</th>
                                                <th>Duración (min)</th>
                                                <th>Estado</th>
                                                <th>Acciones</th>
                                            </tr>
                                        </thead>
                                        <tbody id="serviciosTableBody">
                                            <!-- Aquí se cargarán los datos dinámicamente -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Métodos de Pago Tab -->
                    <div class="tab-pane fade" id="metodos-pago" role="tabpanel" aria-labelledby="metodos-tab">
                        <div class="card shadow mb-4">
                            <div class="card-header py-3 d-flex justify-content-between align-items-center">
                                <h6 class="m-0 font-weight-bold text-primary">Configuración de MercadoPago</h6>
                                <small class="text-muted">Solo lectura - Configuración desde el servidor</small>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-bordered table-hover" id="metodosPagoTable" width="100%" cellspacing="0">
                                        <thead>
                                            <tr>
                                                <th>ID</th>
                                                <th>Nombre</th>
                                                <th>Tipo</th>
                                                <th>Comisión (%)</th>
                                                <th>Estado</th>
                                                <th>Acciones</th>
                                            </tr>
                                        </thead>
                                        <tbody id="metodosPagoTableBody">
                                            <tr>
                                                <td>1</td>
                                                <td>MercadoPago Colombia</td>
                                                <td>Procesador de pagos</td>
                                                <td>5.4%</td>
                                                <td><span class="badge bg-success">Activo</span></td>
                                                <td>
                                                    <small class="text-muted">Configurado</small>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td colspan="6" class="text-center text-muted">
                                                    <i class="bi bi-info-circle"></i> 
                                                    Configuración administrada desde el servidor. 
                                                    Los usuarios pueden pagar directamente desde sus dashboards.
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Pagos a Odontólogos Tab -->
                    <div class="tab-pane fade" id="pagos-odontologos" role="tabpanel" aria-labelledby="pagos-odontologos-tab">
                        <!-- Estadísticas de pagos a odontólogos -->
                        <div class="row mb-4">
                            <div class="col-md-3">
                                <div class="card bg-primary text-white">
                                    <div class="card-body text-center">
                                        <i class="fas fa-user-md fa-2x mb-2"></i>
                                        <h4 id="totalOdontologosAdmin">0</h4>
                                        <p class="mb-0">Odontólogos Activos</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card bg-warning text-white">
                                    <div class="card-body text-center">
                                        <i class="fas fa-clock fa-2x mb-2"></i>
                                        <h4 id="pagosPendientesAdmin">$0</h4>
                                        <p class="mb-0">Pagos Pendientes</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card bg-success text-white">
                                    <div class="card-body text-center">
                                        <i class="fas fa-check-circle fa-2x mb-2"></i>
                                        <h4 id="pagosMesAdmin">$0</h4>
                                        <p class="mb-0">Pagado Este Mes</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card bg-info text-white">
                                    <div class="card-body text-center">
                                        <i class="fas fa-money-bill-wave fa-2x mb-2"></i>
                                        <h4 id="totalComisionesAdmin">$0</h4>
                                        <p class="mb-0">Total Comisiones</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Lista de odontólogos y sus balances -->
                        <div class="card shadow mb-4">
                            <div class="card-header py-3 d-flex justify-content-between align-items-center">
                                <h6 class="m-0 font-weight-bold text-primary">Resumen de Pagos por Odontólogo</h6>
                                <button class="btn btn-success" onclick="abrirModalPagoAdmin()">
                                    <i class="fas fa-plus"></i> Registrar Pago
                                </button>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover" id="tablaOdontologosAdmin">
                                        <thead class="table-dark">
                                            <tr>
                                                <th>Odontólogo</th>
                                                <th>Total Comisiones</th>
                                                <th>Total Pagado</th>
                                                <th>Saldo Pendiente</th>
                                                <th>Estado</th>
                                                <th>Acciones</th>
                                            </tr>
                                        </thead>
                                        <tbody id="tablaOdontologosAdminBody">
                                            <tr>
                                                <td colspan="6" class="text-center py-4">
                                                    <i class="fas fa-spinner fa-spin"></i> Cargando datos...
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Modals -->
    <!-- Modal Usuario -->
    <div class="modal fade" id="userModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="userModalTitle">Nuevo Usuario</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="userForm">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Nombre</label>
                                    <input type="text" class="form-control" id="userNombre" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Apellido</label>
                                    <input type="text" class="form-control" id="userApellido" required>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Email</label>
                            <input type="email" class="form-control" id="userEmail" required>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Tipo de Documento</label>
                                    <select class="form-select" id="userTipoDocumento">
                                        <option value="CC">Cédula de Ciudadanía</option>
                                        <option value="TI">Tarjeta de Identidad</option>
                                        <option value="CE">Cédula de Extranjería</option>
                                        <option value="PA">Pasaporte</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Número de Documento</label>
                                    <input type="text" class="form-control" id="userNumeroDocumento">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Teléfono</label>
                                    <input type="tel" class="form-control" id="userTelefono">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Rol</label>
                                    <select class="form-select" id="userRol" required>
                                        <option value="">Seleccionar rol</option>
                                        <option value="paciente">Paciente</option>
                                        <option value="odontologo">Odontólogo</option>
                                        <option value="administrador">Administrador</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Dirección</label>
                            <input type="text" class="form-control" id="userDireccion">
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Fecha de Nacimiento</label>
                                    <input type="date" class="form-control" id="userFechaNacimiento">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Contraseña</label>
                                    <input type="password" class="form-control" id="userPassword">
                                    <small class="form-text text-muted">Dejar vacío para mantener la actual (solo en edición)</small>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="saveUserBtn">Guardar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Pago a Odontólogo -->
    <div class="modal fade" id="modalPagoOdontologoAdmin" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="fas fa-money-bill-wave"></i> Registrar Pago a Odontólogo
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="formPagoOdontologoAdmin">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="odontologoPagoAdmin" class="form-label">Odontólogo *</label>
                                <select class="form-select" id="odontologoPagoAdmin" required>
                                    <option value="">Seleccionar odontólogo...</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="fechaPagoAdmin" class="form-label">Fecha de Pago *</label>
                                <input type="date" class="form-control" id="fechaPagoAdmin" required>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="tipoPagoAdmin" class="form-label">Tipo de Pago *</label>
                                <select class="form-select" id="tipoPagoAdmin" required>
                                    <option value="">Seleccionar tipo...</option>
                                    <option value="comision">Comisión por Servicios</option>
                                    <option value="salario">Salario Base</option>
                                    <option value="bono">Bono/Incentivo</option>
                                    <option value="ajuste">Ajuste</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="metodoPagoAdmin" class="form-label">Método de Pago *</label>
                                <select class="form-select" id="metodoPagoAdmin" required>
                                    <option value="">Seleccionar método...</option>
                                    <option value="transferencia">Transferencia Bancaria</option>
                                    <option value="efectivo">Efectivo</option>
                                    <option value="cheque">Cheque</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-8 mb-3">
                                <label for="montoPagoAdmin" class="form-label">Monto *</label>
                                <input type="number" class="form-control" id="montoPagoAdmin" 
                                       step="0.01" min="0" required>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="comisionPorcentajeAdmin" class="form-label">Comisión (%)</label>
                                <input type="number" class="form-control" id="comisionPorcentajeAdmin" 
                                       step="0.1" min="0" max="100" placeholder="40">
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label for="conceptoPagoAdmin" class="form-label">Concepto</label>
                            <textarea class="form-control" id="conceptoPagoAdmin" rows="3" 
                                      placeholder="Descripción del pago (servicios realizados, período, etc.)"></textarea>
                        </div>
                        
                        <div class="mb-3">
                            <label for="referenciaPagoAdmin" class="form-label">Referencia/Comprobante</label>
                            <input type="text" class="form-control" id="referenciaPagoAdmin" 
                                   placeholder="Número de transferencia, cheque, etc.">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-success" onclick="registrarPagoOdontologoAdmin()">
                        <i class="fas fa-save"></i> Registrar Pago
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Cita -->
    <div class="modal fade" id="citaModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="citaModalTitle">Nueva Cita</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="citaForm">
                        <div class="mb-3">
                            <label class="form-label">Paciente</label>
                            <input type="text" class="form-control" id="citaPaciente" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Odontólogo</label>
                            <input type="text" class="form-control" id="citaOdontologo" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Fecha</label>
                            <input type="date" class="form-control" id="citaFecha" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Hora</label>
                            <input type="time" class="form-control" id="citaHora" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Estado</label>
                            <select class="form-select" id="citaEstado" required>
                                <option value="programada">Programada</option>
                                <option value="completada">Completada</option>
                                <option value="cancelada">Cancelada</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="saveCitaBtn">Guardar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Inventario Expandido -->
    <div class="modal fade" id="inventarioModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="inventarioModalTitle">
                        <i class="bi bi-box-seam"></i> Nuevo Producto de Inventario
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="inventarioForm">
                        <!-- Información básica -->
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Código del Producto</label>
                                    <input type="text" class="form-control" id="invCodigo" placeholder="Ej: MED001" required>
                                    <small class="text-muted">Código único identificador</small>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Nombre del Producto</label>
                                    <input type="text" class="form-control" id="invNombre" placeholder="Ej: Guantes de látex" required>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Categoría</label>
                                    <select class="form-select" id="invCategoria" required>
                                        <option value="">Seleccionar categoría</option>
                                        <option value="material_medico">Material Médico</option>
                                        <option value="instrumental">Instrumental</option>
                                        <option value="equipos">Equipos</option>
                                        <option value="medicamentos">Medicamentos</option>
                                        <option value="consumibles">Consumibles</option>
                                        <option value="limpieza">Limpieza</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Sede</label>
                                    <select class="form-select" id="invSede" required>
                                        <option value="">Seleccionar sede</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Control de stock -->
                        <div class="row">
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label class="form-label">Cantidad Inicial</label>
                                    <input type="number" class="form-control" id="invCantidad" min="0" required>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label class="form-label">Stock Mínimo</label>
                                    <input type="number" class="form-control" id="invStockMinimo" min="0" required>
                                    <small class="text-muted">Alerta cuando esté por debajo</small>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label class="form-label">Stock Máximo</label>
                                    <input type="number" class="form-control" id="invStockMaximo" min="0">
                                    <small class="text-muted">Opcional</small>
                                </div>
                            </div>
                        </div>

                        <!-- Precios y proveedores -->
                        <div class="row">
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label class="form-label">Precio Unitario</label>
                                    <div class="input-group">
                                        <span class="input-group-text">$</span>
                                        <input type="number" class="form-control" id="invPrecio" min="0" step="0.01" required>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label class="form-label">Unidad de Medida</label>
                                    <select class="form-select" id="invUnidadMedida">
                                        <option value="unidad">Unidad</option>
                                        <option value="caja">Caja</option>
                                        <option value="paquete">Paquete</option>
                                        <option value="kg">Kilogramo</option>
                                        <option value="litro">Litro</option>
                                        <option value="metro">Metro</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label class="form-label">Proveedor</label>
                                    <select class="form-select" id="invProveedor">
                                        <option value="">Sin proveedor</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Información adicional -->
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Fecha de Vencimiento</label>
                                    <input type="date" class="form-control" id="invFechaVencimiento">
                                    <small class="text-muted">Solo si aplica</small>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Ubicación Física</label>
                                    <input type="text" class="form-control" id="invUbicacion" placeholder="Ej: Estante A-2, Gaveta 3">
                                </div>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Descripción</label>
                            <textarea class="form-control" id="invDescripcion" rows="3" placeholder="Descripción detallada del producto, características especiales, etc."></textarea>
                        </div>

                        <!-- Configuración de alertas -->
                        <div class="card bg-light">
                            <div class="card-body">
                                <h6 class="card-title">
                                    <i class="bi bi-bell"></i> Configuración de Alertas
                                </h6>
                                <div class="form-check mb-2">
                                    <input class="form-check-input" type="checkbox" id="invAlertaStockBajo" checked>
                                    <label class="form-check-label" for="invAlertaStockBajo">
                                        Alerta de stock bajo
                                    </label>
                                </div>
                                <div class="form-check mb-2">
                                    <input class="form-check-input" type="checkbox" id="invAlertaVencimiento">
                                    <label class="form-check-label" for="invAlertaVencimiento">
                                        Alerta de próximo vencimiento
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="invRequiereReceta">
                                    <label class="form-check-label" for="invRequiereReceta">
                                        Requiere prescripción médica
                                    </label>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="bi bi-x-circle"></i> Cancelar
                    </button>
                    <button type="button" class="btn btn-primary" id="saveInventarioBtn">
                        <i class="bi bi-save"></i> Guardar Producto
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Sede Expandido -->
    <div class="modal fade" id="sedeModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="sedeModalTitle">
                        <i class="bi bi-building"></i> Nueva Sede
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="sedeForm">
                        <!-- Información básica -->
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Código de Sede</label>
                                    <input type="text" class="form-control" id="sedeCodigo" placeholder="Ej: SED001" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Nombre de la Sede</label>
                                    <input type="text" class="form-control" id="sedeNombre" placeholder="Ej: Sede Centro" required>
                                </div>
                            </div>
                        </div>

                        <!-- Ubicación -->
                        <div class="mb-3">
                            <label class="form-label">Dirección Completa</label>
                            <textarea class="form-control" id="sedeDireccion" rows="2" placeholder="Dirección completa con referencia" required></textarea>
                        </div>

                        <div class="row">
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label class="form-label">Ciudad</label>
                                    <input type="text" class="form-control" id="sedeCiudad" required>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label class="form-label">Departamento</label>
                                    <input type="text" class="form-control" id="sedeDepartamento" required>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label class="form-label">Código Postal</label>
                                    <input type="text" class="form-control" id="sedeCodigoPostal">
                                </div>
                            </div>
                        </div>

                        <!-- Contacto -->
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Teléfono Principal</label>
                                    <input type="tel" class="form-control" id="sedeTelefono" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Email</label>
                                    <input type="email" class="form-control" id="sedeEmail">
                                </div>
                            </div>
                        </div>

                        <!-- Horarios -->
                        <div class="card bg-light mb-3">
                            <div class="card-body">
                                <h6 class="card-title">
                                    <i class="bi bi-clock"></i> Horarios de Atención
                                </h6>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label">Lunes a Viernes</label>
                                            <div class="row">
                                                <div class="col-6">
                                                    <input type="time" class="form-control" id="sedeHorarioLVInicio" placeholder="Inicio">
                                                </div>
                                                <div class="col-6">
                                                    <input type="time" class="form-control" id="sedeHorarioLVFin" placeholder="Fin">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label">Sábados</label>
                                            <div class="row">
                                                <div class="col-6">
                                                    <input type="time" class="form-control" id="sedeHorarioSabInicio">
                                                </div>
                                                <div class="col-6">
                                                    <input type="time" class="form-control" id="sedeHorarioSabFin">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="sedeAbiertoDomingos">
                                    <label class="form-check-label" for="sedeAbiertoDomingos">
                                        Abierto los domingos
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- Información adicional -->
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Responsable de Sede</label>
                                    <input type="text" class="form-control" id="sedeResponsable" placeholder="Nombre del responsable">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Capacidad Máxima</label>
                                    <input type="number" class="form-control" id="sedeCapacidad" min="1" placeholder="Número de consultorios">
                                </div>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Servicios Disponibles</label>
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="servicioConsulta" checked>
                                        <label class="form-check-label" for="servicioConsulta">Consulta General</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="servicioOrtodoncia">
                                        <label class="form-check-label" for="servicioOrtodoncia">Ortodoncia</label>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="servicioImplantes">
                                        <label class="form-check-label" for="servicioImplantes">Implantes</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="servicioEndodoncia">
                                        <label class="form-check-label" for="servicioEndodoncia">Endodoncia</label>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="servicioCirugia">
                                        <label class="form-check-label" for="servicioCirugia">Cirugía Oral</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="servicioBlanqueamiento">
                                        <label class="form-check-label" for="servicioBlanqueamiento">Blanqueamiento</label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Observaciones</label>
                            <textarea class="form-control" id="sedeObservaciones" rows="3" placeholder="Información adicional sobre la sede..."></textarea>
                        </div>

                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="sedeActiva" checked>
                            <label class="form-check-label" for="sedeActiva">
                                Sede activa y disponible para citas
                            </label>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="bi bi-x-circle"></i> Cancelar
                    </button>
                    <button type="button" class="btn btn-primary" id="saveSedeBtn">
                        <i class="bi bi-save"></i> Guardar Sede
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Nueva Categoría -->
    <div class="modal fade" id="categoriaModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="bi bi-tags"></i> Nueva Categoría
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="categoriaForm">
                        <div class="mb-3">
                            <label class="form-label">Nombre de la Categoría</label>
                            <input type="text" class="form-control" id="categoriaNombre" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Descripción</label>
                            <textarea class="form-control" id="categoriaDescripcion" rows="3"></textarea>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Color de Identificación</label>
                            <input type="color" class="form-control form-control-color" id="categoriaColor" value="#0d6efd">
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="categoriaActiva" checked>
                            <label class="form-check-label" for="categoriaActiva">
                                Categoría activa
                            </label>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="saveCategoriaBtn">Guardar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Nuevo Proveedor -->
    <div class="modal fade" id="proveedorModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="bi bi-truck"></i> Nuevo Proveedor
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="proveedorForm">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Nombre de la Empresa</label>
                                    <input type="text" class="form-control" id="proveedorEmpresa" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">NIT/RUT</label>
                                    <input type="text" class="form-control" id="proveedorNIT" required>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Persona de Contacto</label>
                                    <input type="text" class="form-control" id="proveedorContacto" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Cargo</label>
                                    <input type="text" class="form-control" id="proveedorCargo">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Teléfono</label>
                                    <input type="tel" class="form-control" id="proveedorTelefono" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Email</label>
                                    <input type="email" class="form-control" id="proveedorEmail" required>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Dirección</label>
                            <textarea class="form-control" id="proveedorDireccion" rows="2"></textarea>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Especialidades</label>
                                    <input type="text" class="form-control" id="proveedorEspecialidades" placeholder="Ej: Material médico, Instrumental">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Tiempo de Entrega (días)</label>
                                    <input type="number" class="form-control" id="proveedorTiempoEntrega" min="1" value="7">
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Observaciones</label>
                            <textarea class="form-control" id="proveedorObservaciones" rows="3"></textarea>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="proveedorActivo" checked>
                            <label class="form-check-label" for="proveedorActivo">
                                Proveedor activo
                            </label>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="saveProveedorBtn">Guardar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Alertas de Stock -->
    <div class="modal fade" id="alertasStockModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="bi bi-exclamation-triangle text-warning"></i> Alertas de Inventario
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th>Producto</th>
                                    <th>Sede</th>
                                    <th>Stock Actual</th>
                                    <th>Stock Mínimo</th>
                                    <th>Estado</th>
                                </tr>
                            </thead>
                            <tbody id="alertasStockTableBody">
                                <tr>
                                    <td colspan="6" class="text-center">
                                        <div class="spinner-border text-primary" role="status">
                                            <span class="visually-hidden">Cargando alertas...</span>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Detalles de Cita -->
    <div class="modal fade" id="citaDetallesModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Detalles de la Cita</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h6 class="text-primary">Información de la Cita</h6>
                            <p><strong>ID:</strong> <span id="citaDetalleId"></span></p>
                            <p><strong>Fecha:</strong> <span id="citaDetalleFecha"></span></p>
                            <p><strong>Hora:</strong> <span id="citaDetalleHora"></span></p>
                            <p><strong>Estado:</strong> <span id="citaDetalleEstado" class="badge"></span></p>
                            <p><strong>Motivo:</strong> <span id="citaDetalleMotivo"></span></p>
                        </div>
                        <div class="col-md-6">
                            <h6 class="text-primary">Información del Paciente</h6>
                            <p><strong>Nombre:</strong> <span id="citaDetallePaciente"></span></p>
                            <p><strong>Email:</strong> <span id="citaDetallePacienteEmail"></span></p>
                            <p><strong>Teléfono:</strong> <span id="citaDetallePacienteTelefono"></span></p>
                            
                            <h6 class="text-primary mt-3">Odontólogo Asignado</h6>
                            <p><strong>Nombre:</strong> <span id="citaDetalleOdontologo"></span></p>
                            <p><strong>Email:</strong> <span id="citaDetalleOdontologoEmail"></span></p>
                        </div>
                    </div>
                    
                    <div class="row mt-3">
                        <div class="col-12">
                            <h6 class="text-primary">Notas</h6>
                            <p id="citaDetalleNotas" class="border p-2 rounded bg-light"></p>
                        </div>
                    </div>

                    <div class="row mt-3">
                        <div class="col-md-6">
                            <h6 class="text-primary">Cambiar Estado</h6>
                            <select class="form-select" id="nuevoEstadoCita">
                                <option value="programada">Programada</option>
                                <option value="confirmada">Confirmada</option>
                                <option value="completada">Completada</option>
                                <option value="cancelada">Cancelada</option>
                            </select>
                        </div>
                        <div class="col-md-6" id="notasCancelacionDiv" style="display: none;">
                            <h6 class="text-primary">Notas de Cancelación</h6>
                            <textarea class="form-control" id="notasCancelacion" rows="2" placeholder="Motivo de cancelación..."></textarea>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                    <button type="button" class="btn btn-primary" id="actualizarEstadoCitaBtn">Actualizar Estado</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Reasignar Odontólogo -->
    <div class="modal fade" id="reasignarOdontologoModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Reasignar Odontólogo</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <h6>Información de la Cita</h6>
                        <p><strong>Paciente:</strong> <span id="reasignarPaciente"></span></p>
                        <p><strong>Fecha:</strong> <span id="reasignarFecha"></span></p>
                        <p><strong>Hora:</strong> <span id="reasignarHora"></span></p>
                        <p><strong>Odontólogo actual:</strong> <span id="reasignarOdontologoActual"></span></p>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label"><strong>Nuevo Odontólogo:</strong></label>
                        <select class="form-select" id="nuevoOdontologoSelect">
                            <option value="">Cargando odontólogos...</option>
                        </select>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">Motivo del cambio:</label>
                        <textarea class="form-control" id="motivoCambioOdontologo" rows="2" placeholder="Opcional: Especifique el motivo del cambio"></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-warning" id="confirmarReasignacionBtn">Reasignar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Historial General -->
    <div class="modal fade" id="historialGeneralModal" tabindex="-1" aria-labelledby="historialGeneralModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="historialGeneralModalLabel">
                        <i class="bi bi-clock-history"></i> Historial de Cambios
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <!-- Estadísticas -->
                    <div class="row mb-4">
                        <div class="col-md-3">
                            <div class="card text-center">
                                <div class="card-body">
                                    <h5 class="card-title text-primary" id="totalCitasCambios">0</h5>
                                    <p class="card-text">Citas con Cambios</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card text-center">
                                <div class="card-body">
                                    <h5 class="card-title text-warning" id="totalReasignaciones">0</h5>
                                    <p class="card-text">Reasignaciones</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card text-center">
                                <div class="card-body">
                                    <h5 class="card-title text-info" id="totalCambiosEstado">0</h5>
                                    <p class="card-text">Cambios de Estado</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card text-center">
                                <div class="card-body">
                                    <h5 class="card-title text-success" id="totalReprogramaciones">0</h5>
                                    <p class="card-text">Reprogramaciones</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Tabla de historial -->
                    <div class="table-responsive">
                        <table class="table table-striped" id="historialTable">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Fecha Cita</th>
                                    <th>Paciente</th>
                                    <th>Odontólogo</th>
                                    <th>Estado</th>
                                    <th>Total Cambios</th>
                                    <th>Último Cambio</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Se carga dinámicamente -->
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Perfil de Administrador -->
    <div class="modal fade" id="profileModal" tabindex="-1" aria-labelledby="profileModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title" id="profileModalLabel">
                        <i class="bi bi-person-circle"></i> Editar Perfil Personal
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="profileForm">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="profileNombre" class="form-label">Nombre</label>
                                    <input type="text" class="form-control" id="profileNombre" required 
                                        aria-describedby="nombreHelp">
                                    <div id="nombreHelp" class="form-text">Mínimo 2 caracteres</div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="profileApellido" class="form-label">Apellido</label>
                                    <input type="text" class="form-control" id="profileApellido" required
                                        aria-describedby="apellidoHelp">
                                    <div id="apellidoHelp" class="form-text">Mínimo 2 caracteres</div>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="profileEmail" class="form-label">Email</label>
                            <input type="email" class="form-control" id="profileEmail" required readonly>
                            <div class="form-text">El email no se puede modificar</div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="profileTipoDocumento" class="form-label">Tipo de Documento</label>
                                    <select class="form-select" id="profileTipoDocumento">
                                        <option value="CC">Cédula de Ciudadanía</option>
                                        <option value="TI">Tarjeta de Identidad</option>
                                        <option value="CE">Cédula de Extranjería</option>
                                        <option value="PA">Pasaporte</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="profileNumeroDocumento" class="form-label">Número de Documento</label>
                                    <input type="text" class="form-control" id="profileNumeroDocumento">
                                    <div class="form-text">El número de documento no se puede modificar</div>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="profileTelefono" class="form-label">Teléfono</label>
                            <input type="tel" class="form-control" id="profileTelefono" 
                                aria-describedby="telefonoHelp">
                            <div id="telefonoHelp" class="form-text">Formato: +57XXXXXXXXXX o 10-15 dígitos</div>
                        </div>
                        <div class="mb-3">
                            <label for="profileDireccion" class="form-label">Dirección</label>
                            <input type="text" class="form-control" id="profileDireccion">
                        </div>
                        <div class="mb-3">
                            <label for="profileFechaNacimiento" class="form-label">Fecha de Nacimiento</label>
                            <input type="date" class="form-control" id="profileFechaNacimiento">
                        </div>
                        <div class="d-grid gap-2 mt-4">
                            <button type="button" class="btn btn-warning" onclick="adminPasswordModule.openPasswordModal()">
                                <i class="bi bi-shield-lock"></i> Cambiar Contraseña
                            </button>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="saveProfileBtn">Guardar Cambios</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal Historial Específico -->
    <div class="modal fade" id="historialEspecificoModal" tabindex="-1" aria-labelledby="historialEspecificoModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="historialEspecificoModalLabel">
                        <i class="bi bi-file-earmark-text"></i> Historial de Cita
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <!-- Información de la cita -->
                    <div class="card mb-3">
                        <div class="card-header">
                            <h6 class="mb-0">Información Actual</h6>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <p><strong>ID:</strong> <span id="citaId">-</span></p>
                                    <p><strong>Paciente:</strong> <span id="citaPaciente">-</span></p>
                                    <p><strong>Estado:</strong> <span id="citaEstado">-</span></p>
                                </div>
                                <div class="col-md-6">
                                    <p><strong>Fecha:</strong> <span id="citaFecha">-</span></p>
                                    <p><strong>Hora:</strong> <span id="citaHora">-</span></p>
                                    <p><strong>Odontólogo:</strong> <span id="citaOdontologo">-</span></p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Historial de cambios -->
                    <div class="card">
                        <div class="card-header">
                            <h6 class="mb-0">Historial de Cambios</h6>
                        </div>
                        <div class="card-body">
                            <div id="historialCambios">
                                <!-- Se carga dinámicamente -->
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Cambio de Contraseña -->
    <div class="modal fade" id="passwordModal" tabindex="-1" aria-labelledby="passwordModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-warning text-dark">
                    <h5 class="modal-title" id="passwordModalLabel">
                        <i class="bi bi-shield-lock"></i> Cambiar Contraseña
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="passwordForm">
                        <div class="mb-3">
                            <label for="currentPassword" class="form-label">Contraseña Actual</label>
                            <div class="input-group">
                                <input type="password" class="form-control" id="currentPassword" required>
                                <button class="btn btn-outline-secondary toggle-password" type="button" tabindex="-1">
                                    <i class="bi bi-eye"></i>
                                </button>
                            </div>
                        </div>
                        
                        <hr>
                        
                        <div class="mb-3">
                            <label for="newPassword" class="form-label">Nueva Contraseña</label>
                            <div class="input-group">
                                <input type="password" class="form-control" id="newPassword" 
                                    aria-describedby="passwordHelp" required>
                                <button class="btn btn-outline-secondary toggle-password" type="button" tabindex="-1">
                                    <i class="bi bi-eye"></i>
                                </button>
                            </div>
                            <div class="mt-2">
                                <label for="passwordStrength" class="form-label mb-0">Seguridad:</label>
                                <div class="progress">
                                    <div id="passwordStrength" class="progress-bar" role="progressbar" style="width: 0%" 
                                        aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                                <small id="passwordFeedback" class="form-text text-danger"></small>
                            </div>
                            <div id="passwordHelp" class="form-text">
                                La contraseña debe tener al menos 8 caracteres, incluir mayúsculas, minúsculas y números.
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label for="confirmPassword" class="form-label">Confirmar Contraseña</label>
                            <div class="input-group">
                                <input type="password" class="form-control" id="confirmPassword" required>
                                <button class="btn btn-outline-secondary toggle-password" type="button" tabindex="-1">
                                    <i class="bi bi-eye"></i>
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-warning" id="savePasswordBtn">Cambiar Contraseña</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal Configuración del Sistema -->
    <div class="modal fade" id="configModal" tabindex="-1" aria-labelledby="configModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-info text-white">
                    <h5 class="modal-title" id="configModalLabel">
                        <i class="bi bi-gear-fill"></i> Configuración del Sistema
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <ul class="nav nav-tabs mb-4" id="configTabs" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="horarios-tab" data-bs-toggle="tab" data-bs-target="#horarios" 
                                type="button" role="tab" aria-controls="horarios" aria-selected="true">
                                <i class="bi bi-clock"></i> Horarios
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="notificaciones-tab" data-bs-toggle="tab" data-bs-target="#notificaciones" 
                                type="button" role="tab" aria-controls="notificaciones" aria-selected="false">
                                <i class="bi bi-bell"></i> Notificaciones
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="general-tab" data-bs-toggle="tab" data-bs-target="#general" 
                                type="button" role="tab" aria-controls="general" aria-selected="false">
                                <i class="bi bi-gear"></i> General
                            </button>
                        </li>
                    </ul>
                    
                    <form id="configForm">
                        <div class="tab-content" id="configTabContent">
                            <!-- Tab Horarios -->
                            <div class="tab-pane fade show active" id="horarios" role="tabpanel" aria-labelledby="horarios-tab">
                                <h6 class="mb-3">Horario de Atención</h6>
                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <label for="horaApertura" class="form-label">Hora de Apertura</label>
                                        <input type="time" class="form-control" id="horaApertura" required>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="horaCierre" class="form-label">Hora de Cierre</label>
                                        <input type="time" class="form-control" id="horaCierre" required>
                                    </div>
                                </div>
                                
                                <div class="mb-4">
                                    <label class="form-label">Días de Atención</label>
                                    <div class="row">
                                        <div class="col-md-4">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" name="diasHabiles" value="Lun" id="checkLunes">
                                                <label class="form-check-label" for="checkLunes">Lunes</label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" name="diasHabiles" value="Mar" id="checkMartes">
                                                <label class="form-check-label" for="checkMartes">Martes</label>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" name="diasHabiles" value="Mie" id="checkMiercoles">
                                                <label class="form-check-label" for="checkMiercoles">Miércoles</label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" name="diasHabiles" value="Jue" id="checkJueves">
                                                <label class="form-check-label" for="checkJueves">Jueves</label>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" name="diasHabiles" value="Vie" id="checkViernes">
                                                <label class="form-check-label" for="checkViernes">Viernes</label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" name="diasHabiles" value="Sab" id="checkSabado">
                                                <label class="form-check-label" for="checkSabado">Sábado</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Tab Notificaciones -->
                            <div class="tab-pane fade" id="notificaciones" role="tabpanel" aria-labelledby="notificaciones-tab">
                                <h6 class="mb-3">Recordatorios de Citas</h6>
                                <div class="mb-3">
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="smsEnabled">
                                        <label class="form-check-label" for="smsEnabled">Enviar recordatorio por SMS</label>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="emailEnabled">
                                        <label class="form-check-label" for="emailEnabled">Enviar recordatorio por Email</label>
                                    </div>
                                </div>
                                <div class="mb-4">
                                    <label for="horasAnticipacion" class="form-label">Horas de anticipación</label>
                                    <input type="number" class="form-control" id="horasAnticipacion" min="1" max="72" value="24">
                                    <div class="form-text">Cuántas horas antes de la cita se envía el recordatorio.</div>
                                </div>
                                
                                <h6 class="mb-3">Política de Cancelación</h6>
                                <div class="mb-3">
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="permiteCancelacion">
                                        <label class="form-check-label" for="permiteCancelacion">Permitir cancelación de citas</label>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="horasMinCancelacion" class="form-label">Horas mínimas de anticipación</label>
                                            <input type="number" class="form-control" id="horasMinCancelacion" min="0" max="48" value="12">
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="penalizacionCancelacion" class="form-label">% de penalización</label>
                                            <input type="number" class="form-control" id="penalizacionCancelacion" min="0" max="100" value="0">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Tab General -->
                            <div class="tab-pane fade" id="general" role="tabpanel" aria-labelledby="general-tab">
                                <h6 class="mb-3">Información de la Clínica</h6>
                                <div class="mb-3">
                                    <label for="nombreClinica" class="form-label">Nombre de la Clínica</label>
                                    <input type="text" class="form-control" id="nombreClinica" required>
                                </div>
                                <div class="mb-3">
                                    <label for="logoUrl" class="form-label">URL del Logo</label>
                                    <input type="text" class="form-control" id="logoUrl" placeholder="https://ejemplo.com/logo.png">
                                    <div class="form-text">Deje en blanco para usar el logo predeterminado.</div>
                                </div>
                                <div class="mb-4">
                                    <label for="colorPrimario" class="form-label">Color Primario</label>
                                    <input type="color" class="form-control form-control-color" id="colorPrimario" value="#0ea5e9">
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="saveConfigBtn">Guardar Configuración</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal Ver Detalles del Pago -->
    <div class="modal fade" id="verPagoModal" tabindex="-1" aria-labelledby="verPagoModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title" id="verPagoModalLabel">
                        <i class="bi bi-cash-coin"></i> Detalles del Pago
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-4 p-3 border rounded bg-light">
                        <div class="row">
                            <div class="col-md-6">
                                <p class="mb-1"><strong>ID de Pago:</strong> <span id="detallePagoId"></span></p>
                                <p class="mb-1"><strong>Paciente:</strong> <span id="detallePacienteNombre"></span></p>
                                <p class="mb-1"><strong>Fecha:</strong> <span id="detalleFecha"></span></p>
                                <p class="mb-1"><strong>Método:</strong> <span id="detalleMetodo"></span></p>
                            </div>
                            <div class="col-md-6">
                                <p class="mb-1"><strong>Monto:</strong> <span id="detalleMonto" class="text-primary fw-bold"></span></p>
                                <p class="mb-1"><strong>Estado:</strong> <span id="detalleEstado"></span></p>
                                <p class="mb-1"><strong>Concepto:</strong> <span id="detalleConcepto"></span></p>
                                <p class="mb-1"><strong>Referencia:</strong> <span id="detalleReferencia"></span></p>
                            </div>
                        </div>
                    </div>
                    
                    <h6 class="text-muted mb-3">Tratamientos asociados</h6>
                    <div class="table-responsive">
                        <table class="table table-sm table-hover" id="tablaTratamientosPago">
                            <thead class="table-light">
                                <tr>
                                    <th>Tratamiento</th>
                                    <th>Descripción</th>
                                    <th>Precio</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Los detalles de tratamientos se cargan dinámicamente -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="mt-4">
                        <h6 class="text-muted mb-3">Observaciones</h6>
                        <div class="p-3 border rounded">
                            <p id="detalleObservaciones" class="mb-0"></p>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                    <button type="button" class="btn btn-primary" id="generarFacturaBtn">
                        <i class="bi bi-file-earmark-text"></i> Generar Factura
                    </button>
                    <button type="button" class="btn btn-success" id="enviarFacturaBtn">
                        <i class="bi bi-envelope"></i> Enviar por Email
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal Registrar Nuevo Pago -->
    <div class="modal fade" id="nuevoPagoModal" tabindex="-1" aria-labelledby="nuevoPagoModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-success text-white">
                    <h5 class="modal-title" id="nuevoPagoModalLabel">
                        <i class="bi bi-cash"></i> Registrar Nuevo Pago
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="nuevoPagoForm">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="pacienteSelect" class="form-label">Paciente</label>
                                <select class="form-select" id="pacienteSelect" required>
                                    <option value="" disabled selected>Seleccione un paciente</option>
                                    <!-- Opciones cargadas dinámicamente -->
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="metodoPago" class="form-label">Método de Pago</label>
                                <select class="form-select" id="metodoPago" required>
                                    <option value="efectivo">Efectivo</option>
                                    <option value="tarjeta">Tarjeta Crédito/Débito</option>
                                    <option value="transferencia">Transferencia Bancaria</option>
                                    <option value="otros">Otro</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="montoTotal" class="form-label">Monto Total (COP)</label>
                                <div class="input-group">
                                    <span class="input-group-text">$</span>
                                    <input type="number" class="form-control" id="montoTotal" required min="0">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <label for="conceptoPago" class="form-label">Concepto</label>
                                <select class="form-select" id="conceptoPago" required>
                                    <option value="tratamiento">Pago de tratamiento</option>
                                    <option value="consulta">Consulta</option>
                                    <option value="cuota">Cuota de plan</option>
                                    <option value="abono">Abono</option>
                                    <option value="otros">Otro concepto</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label for="tratamientosSelect" class="form-label">Tratamientos Asociados</label>
                            <select class="form-select" id="tratamientosSelect" multiple size="3">
                                <!-- Opciones cargadas dinámicamente -->
                            </select>
                            <div class="form-text">Mantenga presionado Ctrl para seleccionar múltiples tratamientos</div>
                        </div>
                        
                        <div class="mb-3">
                            <label for="referenciaPago" class="form-label">Referencia de Pago</label>
                            <input type="text" class="form-control" id="referenciaPago" placeholder="Opcional - Ej: Número de transacción">
                        </div>
                        
                        <div class="mb-3">
                            <label for="observacionesPago" class="form-label">Observaciones</label>
                            <textarea class="form-control" id="observacionesPago" rows="3" placeholder="Observaciones adicionales sobre este pago"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-success" id="guardarPagoBtn">Registrar Pago</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal Agregar/Editar Servicio -->
    <div class="modal fade" id="servicioModal" tabindex="-1" aria-labelledby="servicioModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title" id="servicioModalLabel">
                        <i class="bi bi-plus-circle"></i> <span id="servicioModalAction">Agregar</span> Servicio
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="servicioForm">
                        <input type="hidden" id="servicioId">
                        <div class="mb-3">
                            <label for="nombreServicio" class="form-label">Nombre del Servicio/Tratamiento</label>
                            <input type="text" class="form-control" id="nombreServicio" required>
                        </div>
                        <div class="mb-3">
                            <label for="descripcionServicio" class="form-label">Descripción</label>
                            <textarea class="form-control" id="descripcionServicio" rows="3"></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="precioServicio" class="form-label">Precio (COP)</label>
                            <div class="input-group">
                                <span class="input-group-text">$</span>
                                <input type="number" class="form-control" id="precioServicio" required min="0">
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="categoriaServicio" class="form-label">Categoría</label>
                            <select class="form-select" id="categoriaServicio" required>
                                <option value="limpieza">Limpieza</option>
                                <option value="estetica">Estética dental</option>
                                <option value="ortodoncia">Ortodoncia</option>
                                <option value="cirugia">Cirugía oral</option>
                                <option value="endodoncia">Endodoncia</option>
                                <option value="implantes">Implantes</option>
                                <option value="consulta">Consulta</option>
                                <option value="otros">Otros servicios</option>
                            </select>
                        </div>
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="activoServicio" checked>
                            <label class="form-check-label" for="activoServicio">
                                Servicio activo
                            </label>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="guardarServicioBtn">Guardar</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal Configurar Método de Pago -->
    <div class="modal fade" id="metodoModal" tabindex="-1" aria-labelledby="metodoModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-info text-white">
                    <h5 class="modal-title" id="metodoModalLabel">
                        <i class="bi bi-credit-card"></i> <span id="metodoModalAction">Configurar</span> Método de Pago
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="metodoForm">
                        <input type="hidden" id="metodoId">
                        <div class="mb-3">
                            <label for="nombreMetodo" class="form-label">Nombre del Método</label>
                            <input type="text" class="form-control" id="nombreMetodo" required>
                        </div>
                        <div class="mb-3">
                            <label for="descripcionMetodo" class="form-label">Instrucciones</label>
                            <textarea class="form-control" id="descripcionMetodo" rows="3" placeholder="Instrucciones para el paciente"></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="tipoMetodo" class="form-label">Tipo</label>
                            <select class="form-select" id="tipoMetodo" required>
                                <option value="efectivo">Efectivo</option>
                                <option value="tarjeta">Tarjeta crédito/débito</option>
                                <option value="transferencia">Transferencia bancaria</option>
                                <option value="online">Pago en línea</option>
                                <option value="otros">Otro</option>
                            </select>
                        </div>
                        <div class="mb-3" id="detallesBancariosContainer">
                            <label for="detallesBancarios" class="form-label">Detalles Bancarios</label>
                            <textarea class="form-control" id="detallesBancarios" rows="3" placeholder="Número de cuenta, banco, titular, etc."></textarea>
                        </div>
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="activoMetodo" checked>
                            <label class="form-check-label" for="activoMetodo">
                                Método activo
                            </label>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-info" id="guardarMetodoBtn">Guardar</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal Configurar Reporte -->
    <div class="modal fade" id="configurarReporteModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Configurar Reporte Personalizado</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="configurarReporteForm">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Nombre del Reporte</label>
                                    <input type="text" class="form-control" id="nombreReporte" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Tipo de Reporte</label>
                                    <select class="form-select" id="tipoReporteConfig" required>
                                        <option value="">Seleccionar tipo</option>
                                        <option value="financiero">Financiero</option>
                                        <option value="operativo">Operativo</option>
                                        <option value="pacientes">Pacientes</option>
                                        <option value="tratamientos">Tratamientos</option>
                                        <option value="inventario">Inventario</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Período de Análisis</label>
                                    <select class="form-select" id="periodoAnalisis">
                                        <option value="ultimo_mes">Último Mes</option>
                                        <option value="ultimos_3_meses">Últimos 3 Meses</option>
                                        <option value="ultimo_semestre">Último Semestre</option>
                                        <option value="ultimo_ano">Último Año</option>
                                        <option value="personalizado">Período Personalizado</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Formato de Exportación</label>
                                    <select class="form-select" id="formatoExportacion">
                                        <option value="pdf">PDF</option>
                                        <option value="excel">Excel</option>
                                        <option value="csv">CSV</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Campos a Incluir</label>
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="incluirFechas" checked>
                                        <label class="form-check-label" for="incluirFechas">Fechas</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="incluirMontos" checked>
                                        <label class="form-check-label" for="incluirMontos">Montos</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="incluirPacientes" checked>
                                        <label class="form-check-label" for="incluirPacientes">Pacientes</label>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="incluirTratamientos" checked>
                                        <label class="form-check-label" for="incluirTratamientos">Tratamientos</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="incluirOdontologos">
                                        <label class="form-check-label" for="incluirOdontologos">Odontólogos</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="incluirSedes">
                                        <label class="form-check-label" for="incluirSedes">Sedes</label>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="incluirEstadisticas">
                                        <label class="form-check-label" for="incluirEstadisticas">Estadísticas</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="incluirGraficos">
                                        <label class="form-check-label" for="incluirGraficos">Gráficos</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="incluirComparacion">
                                        <label class="form-check-label" for="incluirComparacion">Comparación</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Filtros Adicionales</label>
                            <textarea class="form-control" id="filtrosAdicionales" rows="3" placeholder="Descripción de filtros adicionales..."></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="guardarConfigReporteBtn">Generar Reporte</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Generar Reporte -->
    <div class="modal fade" id="generarReporteModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Generar Reporte</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="generarReporteForm">
                        <div class="mb-3">
                            <label class="form-label">Seleccionar Reporte</label>
                            <select class="form-select" id="seleccionarReporte" required>
                                <option value="">Seleccionar...</option>
                                <option value="ingresos_mensual">Reporte de Ingresos Mensual</option>
                                <option value="citas_periodo">Citas por Período</option>
                                <option value="tratamientos_populares">Tratamientos Más Populares</option>
                                <option value="pacientes_activos">Pacientes Activos</option>
                                <option value="rendimiento_sede">Rendimiento por Sede</option>
                                <option value="inventario_estado">Estado del Inventario</option>
                            </select>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Fecha Desde</label>
                                    <input type="date" class="form-control" id="reporteFechaDesde" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Fecha Hasta</label>
                                    <input type="date" class="form-control" id="reporteFechaHasta" required>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Formato de Salida</label>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="formatoSalida" id="formatoPDF" value="pdf" checked>
                                <label class="form-check-label" for="formatoPDF">PDF</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="formatoSalida" id="formatoExcel" value="excel">
                                <label class="form-check-label" for="formatoExcel">Excel</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="formatoSalida" id="formatoCSV" value="csv">
                                <label class="form-check-label" for="formatoCSV">CSV</label>
                            </div>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="incluirGraficosReporte" checked>
                            <label class="form-check-label" for="incluirGraficosReporte">
                                Incluir gráficos en el reporte
                            </label>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-success" id="procesarReporteBtn">
                        <i class="bi bi-download"></i> Generar y Descargar
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal para Ver Detalles -->
    <div class="modal fade" id="modalVerDetalles" tabindex="-1" aria-labelledby="modalVerDetallesLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalVerDetallesLabel">
                        <i class="bi bi-eye"></i> Ver Detalles
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="modalVerDetallesBody">
                    <!-- Contenido dinámico -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                    <button type="button" class="btn btn-primary" id="btnEditarDesdeDetalles">
                        <i class="bi bi-pencil"></i> Editar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para Editar -->
    <div class="modal fade" id="modalEditar" tabindex="-1" aria-labelledby="modalEditarLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalEditarLabel">
                        <i class="bi bi-pencil"></i> Editar
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="formEditar">
                        <div id="modalEditarBody">
                            <!-- Contenido dinámico del formulario -->
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="btnGuardarCambios">
                        <i class="bi bi-check-lg"></i> Guardar Cambios
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para Confirmar Eliminación -->
    <div class="modal fade" id="modalConfirmarEliminar" tabindex="-1" aria-labelledby="modalConfirmarEliminarLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-danger text-white">
                    <h5 class="modal-title" id="modalConfirmarEliminarLabel">
                        <i class="bi bi-exclamation-triangle"></i> Confirmar Eliminación
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="text-center">
                        <i class="bi bi-exclamation-triangle text-danger" style="font-size: 3rem;"></i>
                        <h5 class="mt-3">¿Está seguro?</h5>
                        <p id="modalEliminarMensaje" class="text-muted">
                            Esta acción no se puede deshacer.
                        </p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-danger" id="btnConfirmarEliminar">
                        <i class="bi bi-trash"></i> Sí, Eliminar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para Agregar Nuevo -->
    <div class="modal fade" id="modalAgregar" tabindex="-1" aria-labelledby="modalAgregarLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-success text-white">
                    <h5 class="modal-title" id="modalAgregarLabel">
                        <i class="bi bi-plus-circle"></i> Agregar Nuevo
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="formAgregar">
                        <div id="modalAgregarBody">
                            <!-- Contenido dinámico del formulario -->
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-success" id="btnGuardarNuevo">
                        <i class="bi bi-check-lg"></i> Guardar
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Bootstrap 5 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- jsPDF CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- xlsx CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <!-- App Config -->
    <script src="js/app-config.js"></script>
    <!-- Fix para Configuración del Sistema -->
    <script src="js/config-fix.js"></script>
    <!-- Custom JS - Archivo original con corrección -->
    <script src="js/dashboard-admin.js"></script>
    <script src="js/admin-modules.js?v=20250915b"></script>
    <!-- Módulo CRUD Completo -->
    <script src="js/admin-crud-fixed.js"></script>
    <!-- Módulo de Pagos -->
    <script src="js/pagos.js"></script>
    <!-- Módulo de Pagos a Odontólogos -->
    <script src="js/pagos-odontologos-admin.js"></script>
    <!-- Script de Debug para Usuarios -->
    <script src="js/debug-usuarios.js"></script>
</body>
</html>
