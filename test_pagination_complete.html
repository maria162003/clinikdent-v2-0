<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Completo Sistema de Paginación</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" rel="stylesheet">
</head>
<body>
    <div class="container-fluid p-4">
        <h1 class="mb-4">Test Completo - Sistema de Paginación</h1>
        
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h5>Estado del Sistema de Paginación</h5>
                    </div>
                    <div class="card-body">
                        <div id="testResults">
                            <p>Iniciando pruebas...</p>
                        </div>
                        <button class="btn btn-primary" id="runTestsBtn">Ejecutar Pruebas</button>
                        <button class="btn btn-success ms-2" id="testAllPaginationBtn">Probar Todas las Secciones</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/pagination-system.js"></script>
    <script>
        // Test completo del sistema de paginación
        document.addEventListener('DOMContentLoaded', function() {
            const testResults = document.getElementById('testResults');
            
            function logResult(message, isSuccess = true) {
                const div = document.createElement('div');
                div.className = `alert ${isSuccess ? 'alert-success' : 'alert-danger'} alert-sm`;
                div.textContent = message;
                testResults.appendChild(div);
            }

            function clearResults() {
                testResults.innerHTML = '';
            }

            // Test básico del sistema
            document.getElementById('runTestsBtn').addEventListener('click', function() {
                clearResults();
                
                // Verificar que window.paginationModules existe
                if (typeof window.paginationModules === 'object') {
                    logResult('✓ window.paginationModules existe');
                    
                    // Verificar todas las secciones
                    const expectedSections = [
                        'inventario', 'sedes', 'categorias', 'proveedores',
                        'usuarios', 'citas', 'evaluaciones', 'faqs', 'reportes', 'pagos'
                    ];
                    
                    expectedSections.forEach(section => {
                        if (window.paginationModules[section]) {
                            logResult(`✓ Sección "${section}" configurada`);
                            
                            // Verificar que tiene función render
                            if (typeof window.paginationModules[section].renderPage === 'function') {
                                logResult(`✓ Sección "${section}" tiene función renderPage`);
                            } else {
                                logResult(`✗ Sección "${section}" NO tiene función renderPage`, false);
                            }
                            
                            // Verificar configuración
                            const config = window.paginationModules[section];
                            if (config.itemsPerPage && config.testData) {
                                logResult(`✓ Sección "${section}" tiene configuración completa (${config.testData.length} items)`);
                            } else {
                                logResult(`✗ Sección "${section}" configuración incompleta`, false);
                            }
                        } else {
                            logResult(`✗ Sección "${section}" NO configurada`, false);
                        }
                    });
                } else {
                    logResult('✗ window.paginationModules NO existe', false);
                }
                
                // Verificar funciones auxiliares
                if (typeof changeItemsPerPageAdmin === 'function') {
                    logResult('✓ Función changeItemsPerPageAdmin existe');
                } else {
                    logResult('✗ Función changeItemsPerPageAdmin NO existe', false);
                }
                
                if (typeof initializePaginationAdmin === 'function') {
                    logResult('✓ Función initializePaginationAdmin existe');
                } else {
                    logResult('✗ Función initializePaginationAdmin NO existe', false);
                }
            });

            // Test de todas las secciones con datos de prueba
            document.getElementById('testAllPaginationBtn').addEventListener('click', function() {
                clearResults();
                logResult('Iniciando pruebas de paginación con datos de prueba...');
                
                const sections = Object.keys(window.paginationModules || {});
                let successCount = 0;
                
                sections.forEach((section, index) => {
                    try {
                        const module = window.paginationModules[section];
                        
                        // Simular datos de prueba
                        const testData = module.testData.slice(0, 25); // Usar primeros 25 items
                        
                        // Crear contenedor temporal para la prueba
                        const tempDiv = document.createElement('div');
                        tempDiv.innerHTML = `
                            <div id="${section}Table">
                                <tbody></tbody>
                            </div>
                            <div id="${section}PaginationInfo" style="display: none;">
                                <span id="${section}Showing">0</span>
                                <span id="${section}Total">0</span>
                                <span id="${section}CurrentPage">1</span>
                                <span id="${section}TotalPages">1</span>
                            </div>
                            <div id="${section}Pagination" style="display: none;"></div>
                        `;
                        document.body.appendChild(tempDiv);
                        
                        // Intentar renderizar página
                        if (typeof module.renderPage === 'function') {
                            module.renderPage(testData, 1, 10);
                            logResult(`✓ Sección "${section}" renderizada correctamente con ${testData.length} items`);
                            successCount++;
                        } else {
                            logResult(`✗ Sección "${section}" no tiene función renderPage`, false);
                        }
                        
                        // Limpiar
                        document.body.removeChild(tempDiv);
                        
                    } catch (error) {
                        logResult(`✗ Error en sección "${section}": ${error.message}`, false);
                    }
                });
                
                logResult(`Resumen: ${successCount}/${sections.length} secciones funcionaron correctamente`, successCount === sections.length);
            });
        });
    </script>
</body>
</html>