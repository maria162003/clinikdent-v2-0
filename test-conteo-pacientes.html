<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Conteo Pacientes</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
</head>
<body>
    <div class="container mt-5">
        <h1>üß™ Test Conteo de Pacientes</h1>
        
        <div class="row mt-4">
            <div class="col-md-4">
                <div class="card text-center">
                    <div class="card-body">
                        <h5 class="card-title">Total Pacientes</h5>
                        <h2 class="text-primary" id="totalPacientes">0</h2>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card text-center">
                    <div class="card-body">
                        <h5 class="card-title">Pacientes Activos</h5>
                        <h2 class="text-success" id="pacientesActivos">0</h2>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card text-center">
                    <div class="card-body">
                        <h5 class="card-title">Pacientes Inactivos</h5>
                        <h2 class="text-secondary" id="pacientesInactivos">0</h2>
                    </div>
                </div>
            </div>
        </div>

        <div class="mt-4">
            <button class="btn btn-primary" onclick="testPacientesLoad()">Cargar Pacientes de Prueba</button>
            <button class="btn btn-secondary" onclick="testStats()">Actualizar Estad√≠sticas</button>
        </div>

        <div class="mt-4">
            <table class="table table-striped" id="pacientesTable">
                <thead>
                    <tr>
                        <th>Nombre</th>
                        <th>Correo</th>
                        <th>Tel√©fono</th>
                        <th>Estado</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td colspan="4" class="text-center">Sin datos</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // Simulaci√≥n de la clase dashboardOdontologo para testing
        const testDashboard = {
            pacientes: [],
            
            updatePacientesStats() {
                console.log('üîç updatePacientesStats llamada - this.pacientes:', this.pacientes);
                if (!this.pacientes) {
                    console.log('‚ö†Ô∏è this.pacientes es null/undefined');
                    return;
                }

                const totalPacientes = this.pacientes.length;
                const pacientesActivos = this.pacientes.filter(p => p.estado === 'Activo').length;
                const pacientesInactivos = this.pacientes.filter(p => p.estado === 'Inactivo').length;

                console.log(`üìä Stats calculadas: Total: ${totalPacientes}, Activos: ${pacientesActivos}, Inactivos: ${pacientesInactivos}`);

                // Actualizar stats en el dashboard
                const totalElement = document.querySelector('#totalPacientes');
                if (totalElement) {
                    console.log(`üìä Actualizando elemento #totalPacientes con valor: ${totalPacientes}`);
                    totalElement.textContent = totalPacientes;
                } else {
                    console.log('‚ö†Ô∏è Elemento #totalPacientes no encontrado en DOM');
                }
                
                if (document.querySelector('#pacientesActivos')) {
                    document.querySelector('#pacientesActivos').textContent = pacientesActivos;
                }
                if (document.querySelector('#pacientesInactivos')) {
                    document.querySelector('#pacientesInactivos').textContent = pacientesInactivos;
                }

                console.log(`üìä Stats pacientes finalizadas: Total: ${totalPacientes}, Activos: ${pacientesActivos}, Inactivos: ${pacientesInactivos}`);
            },

            renderPacientesTable() {
                const tbody = document.querySelector('#pacientesTable tbody');
                tbody.innerHTML = '';
                
                if (!this.pacientes || this.pacientes.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="4" class="text-center">No hay pacientes registrados</td></tr>';
                    return;
                }

                this.pacientes.forEach(paciente => {
                    const row = tbody.insertRow();
                    row.innerHTML = `
                        <td>${paciente.nombre} ${paciente.apellido}</td>
                        <td>${paciente.correo}</td>
                        <td>${paciente.telefono}</td>
                        <td>
                            <span class="badge ${paciente.estado === 'Activo' ? 'bg-success' : 'bg-secondary'}">
                                ${paciente.estado}
                            </span>
                        </td>
                    `;
                });
            }
        };

        function testPacientesLoad() {
            console.log('üß™ Cargando pacientes de ejemplo...');
            
            testDashboard.pacientes = [
                {
                    id: 999,
                    nombre: 'Juan Carlos',
                    apellido: 'P√©rez Garc√≠a',
                    correo: 'juan.perez@email.com',
                    telefono: '3001234567',
                    estado: 'Activo'
                },
                {
                    id: 998,
                    nombre: 'Mar√≠a Elena',
                    apellido: 'Gonz√°lez L√≥pez',
                    correo: 'maria.gonzalez@email.com',
                    telefono: '3007654321',
                    estado: 'Activo'
                },
                {
                    id: 997,
                    nombre: 'Pedro',
                    apellido: 'Ram√≠rez',
                    correo: 'pedro.ramirez@email.com',
                    telefono: '3009876543',
                    estado: 'Inactivo'
                }
            ];
            
            console.log('üìä Array de pacientes de ejemplo - Length:', testDashboard.pacientes.length);
            testDashboard.renderPacientesTable();
            testDashboard.updatePacientesStats();
        }

        function testStats() {
            testDashboard.updatePacientesStats();
        }

        // Auto-cargar datos de ejemplo al cargar la p√°gina
        window.onload = function() {
            testPacientesLoad();
        };
    </script>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
